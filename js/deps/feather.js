var avpw_swfobject=function(){function a(){if(!R){try{var a=K.getElementsByTagName("body")[0].appendChild(q("span"));a.parentNode.removeChild(a)}catch(b){return}R=!0;for(var c=N.length,d=0;c>d;d++)N[d]()}}function b(a){R?a():N[N.length]=a}function c(a){if(typeof J.addEventListener!=C)J.addEventListener("load",a,!1);else if(typeof K.addEventListener!=C)K.addEventListener("load",a,!1);else if(typeof J.attachEvent!=C)r(J,"onload",a);else if("function"==typeof J.onload){var b=J.onload;J.onload=function(){b(),a()}}else J.onload=a}function d(){M?e():f()}function e(){var a=K.getElementsByTagName("body")[0],b=q(D);b.setAttribute("type",G);var c=a.appendChild(b);if(c){var d=0;!function(){if(typeof c.GetVariable!=C){var e=c.GetVariable("$version");e&&(e=e.split(" ")[1].split(","),U.pv=[parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10)])}else if(10>d)return d++,void setTimeout(arguments.callee,10);a.removeChild(b),c=null,f()}()}else f()}function f(){var a=O.length;if(a>0)for(var b=0;a>b;b++){var c=O[b].id,d=O[b].callbackFn,e={success:!1,id:c};if(U.pv[0]>0){var f=p(c);if(f)if(!s(O[b].swfVersion)||U.wk&&U.wk<312)if(O[b].expressInstall&&h()){var k={};k.data=O[b].expressInstall,k.width=f.getAttribute("width")||"0",k.height=f.getAttribute("height")||"0",f.getAttribute("class")&&(k.styleclass=f.getAttribute("class")),f.getAttribute("align")&&(k.align=f.getAttribute("align"));for(var l={},m=f.getElementsByTagName("param"),n=m.length,o=0;n>o;o++)"movie"!=m[o].getAttribute("name").toLowerCase()&&(l[m[o].getAttribute("name")]=m[o].getAttribute("value"));i(k,l,c,d)}else j(f),d&&d(e);else u(c,!0),d&&(e.success=!0,e.ref=g(c),d(e))}else if(u(c,!0),d){var q=g(c);q&&typeof q.SetVariable!=C&&(e.success=!0,e.ref=q),d(e)}}}function g(a){var b=null,c=p(a);if(c&&"OBJECT"==c.nodeName)if(typeof c.SetVariable!=C)b=c;else{var d=c.getElementsByTagName(D)[0];d&&(b=d)}return b}function h(){return!S&&s("6.0.65")&&(U.win||U.mac)&&!(U.wk&&U.wk<312)}function i(a,b,c,d){S=!0,y=d||null,z={success:!1,id:c};var e=p(c);if(e){"OBJECT"==e.nodeName?(w=k(e),x=null):(w=e,x=c),a.id=H,(typeof a.width==C||!/%$/.test(a.width)&&parseInt(a.width,10)<310)&&(a.width="310"),(typeof a.height==C||!/%$/.test(a.height)&&parseInt(a.height,10)<137)&&(a.height="137"),K.title=K.title.slice(0,47)+" - Flash Player Installation";var f=U.ie&&U.win?"ActiveX":"PlugIn",g="MMredirectURL="+encodeURI(window.location).toString().replace(/&/g,"%26")+"&MMplayerType="+f+"&MMdoctitle="+K.title;if(typeof b.flashvars!=C?b.flashvars+="&"+g:b.flashvars=g,U.ie&&U.win&&4!=e.readyState){var h=q("div");c+="SWFObjectNew",h.setAttribute("id",c),e.parentNode.insertBefore(h,e),e.style.display="none",function(){4==e.readyState?e.parentNode.removeChild(e):setTimeout(arguments.callee,10)}()}l(a,b,c)}}function j(a){if(U.ie&&U.win&&4!=a.readyState){var b=q("div");a.parentNode.insertBefore(b,a),b.parentNode.replaceChild(k(a),b),a.style.display="none",function(){4==a.readyState?a.parentNode.removeChild(a):setTimeout(arguments.callee,10)}()}else a.parentNode.replaceChild(k(a),a)}function k(a){var b=q("div");if(U.win&&U.ie)b.innerHTML=a.innerHTML;else{var c=a.getElementsByTagName(D)[0];if(c){var d=c.childNodes;if(d)for(var e=d.length,f=0;e>f;f++)(1!=d[f].nodeType||"PARAM"!=d[f].nodeName)&&8!=d[f].nodeType&&b.appendChild(d[f].cloneNode(!0))}}return b}function l(a,b,c){var d,e=p(c);if(U.wk&&U.wk<312)return d;if(e)if(typeof a.id==C&&(a.id=c),U.ie&&U.win){var f="";for(var g in a)a[g]!=Object.prototype[g]&&("data"==g.toLowerCase()?b.movie=a[g]:"styleclass"==g.toLowerCase()?f+=' class="'+a[g]+'"':"classid"!=g.toLowerCase()&&(f+=" "+g+'="'+a[g]+'"'));var h="";for(var i in b)b[i]!=Object.prototype[i]&&(h+='<param name="'+i+'" value="'+b[i]+'" />');e.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+f+">"+h+"</object>",P[P.length]=a.id,d=p(a.id)}else{var j=q(D);j.setAttribute("type",G);for(var k in a)a[k]!=Object.prototype[k]&&("styleclass"==k.toLowerCase()?j.setAttribute("class",a[k]):"classid"!=k.toLowerCase()&&j.setAttribute(k,a[k]));for(var l in b)b[l]!=Object.prototype[l]&&"movie"!=l.toLowerCase()&&m(j,l,b[l]);e.parentNode.replaceChild(j,e),d=j}return d}function m(a,b,c){var d=q("param");d.setAttribute("name",b),d.setAttribute("value",c),a.appendChild(d)}function n(a){var b=p(a);b&&"OBJECT"==b.nodeName&&(U.ie&&U.win?(b.style.display="none",function(){4==b.readyState?o(a):setTimeout(arguments.callee,10)}()):b.parentNode.removeChild(b))}function o(a){var b=p(a);if(b){for(var c in b)"function"==typeof b[c]&&(b[c]=null);b.parentNode.removeChild(b)}}function p(a){var b=null;try{b=K.getElementById(a)}catch(c){}return b}function q(a){return K.createElement(a)}function r(a,b,c){a.attachEvent(b,c),Q[Q.length]=[a,b,c]}function s(a){var b=U.pv,c=a.split(".");return c[0]=parseInt(c[0],10),c[1]=parseInt(c[1],10)||0,c[2]=parseInt(c[2],10)||0,b[0]>c[0]||b[0]==c[0]&&b[1]>c[1]||b[0]==c[0]&&b[1]==c[1]&&b[2]>=c[2]?!0:!1}function t(a,b,c,d){if(!U.ie||!U.mac){var e=K.getElementsByTagName("head")[0];if(e){var f=c&&"string"==typeof c?c:"screen";if(d&&(A=null,B=null),!A||B!=f){var g=q("style");g.setAttribute("type","text/css"),g.setAttribute("media",f),A=e.appendChild(g),U.ie&&U.win&&typeof K.styleSheets!=C&&K.styleSheets.length>0&&(A=K.styleSheets[K.styleSheets.length-1]),B=f}U.ie&&U.win?A&&typeof A.addRule==D&&A.addRule(a,b):A&&typeof K.createTextNode!=C&&A.appendChild(K.createTextNode(a+" {"+b+"}"))}}}function u(a,b){if(T){var c=b?"visible":"hidden";R&&p(a)?p(a).style.visibility=c:t("#"+a,"visibility:"+c)}}function v(a){var b=/[\\\"<>\.;]/,c=null!=b.exec(a);return c&&typeof encodeURIComponent!=C?encodeURIComponent(a):a}{var w,x,y,z,A,B,C="undefined",D="object",E="Shockwave Flash",F="ShockwaveFlash.ShockwaveFlash",G="application/x-shockwave-flash",H="SWFObjectExprInst",I="onreadystatechange",J=window,K=document,L=navigator,M=!1,N=[d],O=[],P=[],Q=[],R=!1,S=!1,T=!0,U=function(){var a=typeof K.getElementById!=C&&typeof K.getElementsByTagName!=C&&typeof K.createElement!=C,b=L.userAgent.toLowerCase(),c=L.platform.toLowerCase(),d=/win/.test(c?c:b),e=/mac/.test(c?c:b),f=/webkit/.test(b)?parseFloat(b.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,g=!1,h=[0,0,0],i=null;if(typeof L.plugins!=C&&typeof L.plugins[E]==D)i=L.plugins[E].description,i&&(typeof L.mimeTypes==C||!L.mimeTypes[G]||!!L.mimeTypes[G].enabledPlugin)&&(M=!0,g=!1,i=i.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),h[0]=parseInt(i.replace(/^(.*)\..*$/,"$1"),10),h[1]=parseInt(i.replace(/^.*\.(.*)\s.*$/,"$1"),10),h[2]=/[a-zA-Z]/.test(i)?parseInt(i.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof J.ActiveXObject!=C)try{var j=new ActiveXObject(F);j&&(i=j.GetVariable("$version"),i&&(g=!0,i=i.split(" ")[1].split(","),h=[parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10)]))}catch(k){}return{w3:a,pv:h,wk:f,ie:g,win:d,mac:e}}();!function(){U.w3&&((typeof K.readyState!=C&&"complete"==K.readyState||typeof K.readyState==C&&(K.getElementsByTagName("body")[0]||K.body))&&a(),R||(typeof K.addEventListener!=C&&K.addEventListener("DOMContentLoaded",a,!1),U.ie&&U.win&&(K.attachEvent(I,function(){"complete"==K.readyState&&(K.detachEvent(I,arguments.callee),a())}),J==top&&function(){if(!R){try{K.documentElement.doScroll("left")}catch(b){return void setTimeout(arguments.callee,0)}a()}}()),U.wk&&function(){return R?void 0:/loaded|complete/.test(K.readyState)?void a():void setTimeout(arguments.callee,0)}(),c(a)))}(),function(){U.ie&&U.win&&window.attachEvent("onunload",function(){for(var a=Q.length,b=0;a>b;b++)Q[b][0].detachEvent(Q[b][1],Q[b][2]);for(var c=P.length,d=0;c>d;d++)n(P[d]);for(var e in U)U[e]=null;U=null;for(var f in avpw_swfobject)avpw_swfobject[f]=null;avpw_swfobject=null})}()}return{registerObject:function(a,b,c,d){if(U.w3&&a&&b){var e={};e.id=a,e.swfVersion=b,e.expressInstall=c,e.callbackFn=d,O[O.length]=e,u(a,!1)}else d&&d({success:!1,id:a})},getObjectById:function(a){return U.w3?g(a):void 0},embedSWF:function(a,c,d,e,f,g,j,k,m,n){var o={success:!1,id:c};U.w3&&!(U.wk&&U.wk<312)&&a&&c&&d&&e&&f?(u(c,!1),b(function(){d+="",e+="";var b={};if(m&&typeof m===D)for(var p in m)b[p]=m[p];b.data=a,b.width=d,b.height=e;var q={};if(k&&typeof k===D)for(var r in k)q[r]=k[r];if(j&&typeof j===D)for(var t in j)typeof q.flashvars!=C?q.flashvars+="&"+t+"="+j[t]:q.flashvars=t+"="+j[t];if(s(f)){var v=l(b,q,c);b.id==c&&u(c,!0),o.success=!0,o.ref=v}else{if(g&&h())return b.data=g,void i(b,q,c,n);u(c,!0)}n&&n(o)})):n&&n(o)},switchOffAutoHideShow:function(){T=!1},ua:U,getFlashPlayerVersion:function(){return{major:U.pv[0],minor:U.pv[1],release:U.pv[2]}},hasFlashPlayerVersion:s,createSWF:function(a,b,c){return U.w3?l(a,b,c):void 0},showExpressInstall:function(a,b,c,d){U.w3&&h()&&i(a,b,c,d)},removeSWF:function(a){U.w3&&n(a)},createCSS:function(a,b,c,d){U.w3&&t(a,b,c,d)},addDomLoadEvent:b,addLoadEvent:c,getQueryParamValue:function(a){var b=K.location.search||K.location.hash;if(b){if(/\?/.test(b)&&(b=b.split("?")[1]),null==a)return v(b);for(var c=b.split("&"),d=0;d<c.length;d++)if(c[d].substring(0,c[d].indexOf("="))==a)return v(c[d].substring(c[d].indexOf("=")+1))}return""},expressInstallCallback:function(){if(S){var a=p(H);a&&w&&(a.parentNode.replaceChild(w,a),x&&(u(x,!0),U.ie&&U.win&&(w.style.display="block")),y&&y(z)),S=!1}}}}();!function(a){{var b=/\s+/;a.Events={on:function(a,c,d){var e,f,g;if(!c)return this;for(a=a.split(b),e=this._callbacks||(this._callbacks={});f=a.shift();)g=e[f]||(e[f]=[]),g.push(c,d);return this},off:function(a,c,d){var e,f,g,h;if(!(f=this._callbacks))return this;if(!(a||c||d))return delete this._callbacks,this;for(a=a?a.split(b):_.keys(f);e=a.shift();)if((g=f[e])&&(c||d))for(h=g.length-2;h>=0;h-=2)c&&g[h]!==c||d&&g[h+1]!==d||g.splice(h,2);else delete f[e];return this},trigger:function(a){var c,d,e,f,g,h,i,j;if(!(d=this._callbacks))return this;for(j=[],a=a.split(b),f=1,g=arguments.length;g>f;f++)j[f-1]=arguments[f];for(;c=a.shift();){if((i=d.all)&&(i=i.slice()),(e=d[c])&&(e=e.slice()),e)for(f=0,g=e.length;g>f;f+=2)e[f].apply(e[f+1]||this,j);if(i)for(h=[c].concat(j),f=0,g=i.length;g>f;f+=2)i[f].apply(i[f+1]||this,h)}return this}}}}(window.AV||(window.AV={}),window,document),"undefined"==typeof AV&&(AV={}),AV.JSON={},function(){"use strict";function f(a){return 10>a?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(a)),"function"==typeof rep&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;f>c;c+=1)g[c]=str(c,i)||"null";return e=0===g.length?"[]":gap?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e}if(rep&&"object"==typeof rep)for(f=rep.length,c=0;f>c;c+=1)d=rep[c],"string"==typeof d&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));else for(d in i)Object.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));return e=0===g.length?"{}":gap?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof AV.JSON.stringify&&(AV.JSON.stringify=function(a,b,c){var d;if(gap="",indent="","number"==typeof c)for(d=0;c>d;d+=1)indent+=" ";else"string"==typeof c&&(indent=c);if(rep=b,!b||"function"==typeof b||"object"==typeof b&&"number"==typeof b.length)return str("",{"":a});throw new Error("AV.JSON.stringify")}),"function"!=typeof AV.JSON.parse&&(AV.JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("AV.JSON.parse")})}(),function(a){a.build={version:"2.6.2.182",bundled:!1,MINIMUM_FLASH_PLAYER_VERSION:"10.2.0",feather_baseURL:"http://feather.aviary.com/2.6.2.182/",feather_baseURL_SSL:"https://dme0ih8comzn4.cloudfront.net/2.6.2.182/",feather_stickerURL:"http://feather.aviary.com/stickers/",feather_stickerURL_SSL:"https://dme0ih8comzn4.cloudfront.net/stickers/",imgrecvBase:"http://featherservices.aviary.com/",imgrecvBase_SSL:"https://featherservices.aviary.com/",featherTargetAnnounce:"http://featherservices.aviary.com/feather_target_announce_v3.html",featherTargetAnnounce_SSL:"https://featherservices.aviary.com/feather_target_announce_v3.html",imgrecvServer:"http://featherservices.aviary.com/FeatherReceiver.aspx",imgrecvServer_SSL:"https://featherservices.aviary.com/FeatherReceiver.aspx",jsonp_imgserver:"http://featherservices.aviary.com/imgjsonpserver.aspx",jsonp_imgserver_SSL:"https://featherservices.aviary.com/imgjsonpserver.aspx",proxyServer:"http://featherservices.aviary.com/proxy.aspx",proxyServer_SSL:"https://featherservices.aviary.com/proxy.aspx",asyncImgrecvBase:"http://api.aviary.com/",asyncImgrecvBase_SSL:"https://api.aviary.com/",partnerAssetURL:"http://api.aviary.com/getassets",partnerAssetURL_SSL:"https://api.aviary.com/getassets",asyncFeatherTargetAnnounce:"http://api.aviary.com/feather_target_announce_v3.html",asyncFeatherTargetAnnounce_SSL:"https://api.aviary.com/feather_target_announce_v3.html",asyncImgrecvCreateJob:"http://api.aviary.com/createjob",asyncImgrecvCreateJob_SSL:"https://api.aviary.com/createjob",asyncImgrecvGetJobStatus:"http://api.aviary.com/getjobstatus",asyncImgrecvGetJobStatus_SSL:"https://api.aviary.com/getjobstatus",imgtrackServer:"http://featherservices.aviary.com/featherlog.aspx",imgtrackServer_SSL:"https://featherservices.aviary.com/featherlog.aspx",googleTracker:"UA-84575-16",inAppPurchaseFrameURL:"http://purchases.viary.com/gateway.aspx?p=flickr",filterServer:"http://featherservices.aviary.com/moa.ashx",filterServer_SSL:"https://featherservices.aviary.com/moa.ashx",featherFilterAnnounce:"http://featherservices.aviary.com/feather_filter_announce.html",featherFilterAnnounce_SSL:"https://featherservices.aviary.com/feather_filter_announce.html"}}(AV=window.AV||{}),"undefined"==typeof AV&&(AV={}),AV.validLanguages={en:!0,zh_hant:!0,nl:!0,fr:!0,de:!0,it:!0,ja:!0,ko:!0,pl:!0,pt:!0,pt_br:!0,ru:!0,es:!0,tr:!0,bg:!0,ca:!0,zh_hans:!0,cs:!0,da:!0,fi:!0,he:!0,hu:!0,id:!0,lv:!0,lt:!0,sv:!0,vi:!0,no:!0,android:!0,sk:!0,el:!0,sl:!0},function(a,b,c){a.util={getX:function(a){for(var b=0;null!=a;)b+=a.offsetLeft,a=a.offsetParent;return b},getY:function(a){for(var b=0;null!=a;)b+=a.offsetTop,a=a.offsetParent;return b},getTouch:function(a){var b;return a.originalEvent&&(a=a.originalEvent),b=a.changedTouches&&1==a.changedTouches.length?a.changedTouches[0]:a.touches&&1==a.touches.length?a.touches[0]:!1},getScaledDims:function(a,b,c,d){d=d||c;var e=a,f=b,g=a/b;return(a>c||b>d)&&(a-c>g*(b-d)?(e=c,f=c*b/a+.5|0):(e=d*g+.5|0,f=d)),{width:e,height:f}},nextFrame:function(a){setTimeout(a,1)},getDomain:function(a,b){var c,d,e,f,g,h,i;return c="http://"==a.substr(0,7)?7:"https://"==a.substr(0,8)?8:"ftp://"==a.substr(0,6)?6:0,e=a.indexOf("/",c),-1==e&&(e=a.length),b?d=c:(h=a,i=a.lastIndexOf(":"),h=i>c?a.substring(c,i):a.substring(c,e),h.match(/^(?:[0-9]{1,3}\.){3}[0-9]{1,3}$/)?d=c:(f=a.lastIndexOf(".",e),g=a.lastIndexOf(".",f-1),d=-1==g?c:g+1)),a.substring(d,e)},extend:function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[1]||{},h=2),"object"==typeof g||jQuery.isFunction(g)||(g={}),i===h&&(g=this,--h);i>h;h++)if(null!=(a=arguments[h]))for(b in a)c=g[b],d=a[b],g!==d&&(j&&d&&(jQuery.isPlainObject(d)||(e=jQuery.isArray(d)))?(e?(e=!1,f=c&&jQuery.isArray(c)?c:[]):f=c&&jQuery.isPlainObject(c)?c:{},g[b]=jQuery.extend(j,f,d)):void 0!==d&&(g[b]=d));return g},findItemByKeyValueFromArray:function(a,b,c){{var d,e;c.length}for(d=0;d<c.length;d++)if(c[d]&&c[d][a]&&c[d][a]===b){e=c[d];break}return e},loadFile:function(){var a,b,d,e,f=0,g=function(a,b){function c(a){(4==this.readyState||"complete"==this.readyState||"loaded"==this.readyState)&&b(a)}b&&("Microsoft Internet Explorer"==navigator.appName?a.onreadystatechange=c:a.onload=b)};return a=g,function(g,h,i){var j;return"js"==h?(j=c.createElement("script"),j.setAttribute("type","text/javascript"),a(j,i),j.setAttribute("src",g)):"css"==h?c.createStyleSheet?c.createStyleSheet(g,f++):(j=c.createElement("link"),j.setAttribute("rel","stylesheet"),j.setAttribute("type","text/css"),j.setAttribute("href",g)):"img"==h&&(j=c.createElement("img"),a(j,i),j.setAttribute("src",g)),j&&(b=b||c.getElementsByTagName("head")[0],"js"==h?b.appendChild(j):"css"==h&&(d=d||c.createDocumentFragment(),d.appendChild(j),b.insertBefore(j,e))),j}}(),getImageElem:function(a){return"string"==typeof a?c.getElementById(a):a.length?a[0]:a},getImageId:function(a){return"string"==typeof a?a:a.id},imgOnLoad:function(a,b){var c=avpw$(a);c.load(b),(1==c[0].complete||4==c[0].readyState||"complete"==c[0].readyState||"loaded"==c[0].readyState)&&c.trigger("load")},color_is_white:function(a){return a=a.toLowerCase(),"#fff"==a||"#ffffff"==a||"white"==a||"rgb(255,255,255)"==a||"rgb(255, 255, 255)"==a},color_is_light:function(b){var c,d,e,f,g;return c=d=e=0,g=a.util.color_to_array(b),c=g[0],d=g[1],e=g[2],f=.2*c+.7*d+.1*e,f>127.5},color_expand:function(a){var b,c,d;return 4==a.length&&(b=a.charAt(1),c=a.charAt(2),d=a.charAt(3),a="#"+b+b+c+c+d+d),a},color_to_array:function(b){var c,d,e;return"#"==b.charAt(0)?(b=a.util.color_expand(b),c=parseInt(b.substr(1,2),16),d=parseInt(b.substr(3,2),16),e=parseInt(b.substr(5,2),16)):"r"==b.charAt(0).toLowerCase()&&(b=a.util.rgb_to_color(b),c=parseInt(b.substr(1,2),16),d=parseInt(b.substr(3,2),16),e=parseInt(b.substr(5,2),16)),b=[c,d,e,1]},array_to_color:function(b){var c=a.util.array_to_rgb(b);return c=a.util.rgb_to_color(c)},array_to_rgb:function(a){var b="rgb(0,0,0)";return a.join&&(a.length>3&&(a=a.slice(0,3)),b="rgb("+a.join(",")+")"),b},color_to_rgb:function(b){return b=a.util.color_to_array(b),b=a.util.array_to_rgb(b)},rgb_to_color:function(a){var b,c,d,e=/\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)/,f=a.match(e);return f?(b=parseInt(f[1]).toString(16),1==b.length&&(b="0"+b),c=parseInt(f[2]).toString(16),1==c.length&&(c="0"+c),d=parseInt(f[3]).toString(16),1==d.length&&(d="0"+d),"#"+b+c+d):a},color_to_int:function(b){return b=a.util.color_expand(b),b=a.util.rgb_to_color(b),parseInt(b.substr(1),16)},loadImagesSync:function(b,c){for(var d=0,e=b.length,f=0;e>f;f++){var g=b[f].img,h=b[f].src;g.onload=function(){d++,c&&d==b.length&&a.util.nextFrame(c)},g.src=h}},getApiVersion:function(a){return a&&a.apiVersion?parseInt(a.apiVersion,10):1},addFontToPage:function(b,c){b||c&&c();var d=b.label;b.system?c&&c(b):a.WebFont&&(b.familyStyle&&(d+=":"+b.familyStyle),a.WebFont.load({google:{families:[d]},loading:function(){a.controlsWidgetInstance&&a.controlsWidgetInstance.showWaitThrobber(!0)},active:function(){a.controlsWidgetInstance&&a.controlsWidgetInstance.showWaitThrobber(!1),c&&c(b)},inactive:function(){a.controlsWidgetInstance&&a.controlsWidgetInstance.showWaitThrobber(!1),a.errorNotify("UNSUPPORTED_FONT",[d]),c&&c()}}))}}}(window.AV||(window.AV={}),window,document),"undefined"==typeof AV&&(AV={}),AV.FlashAPI=function(){var a="avpw_canvas_swf",b=null,c=function(){var a=function(a,b,c){var d=document.createElement("param");d.setAttribute("name",b),d.setAttribute("value",c),a.appendChild(d)},b=function(b,c,d){var e=document.getElementById(d);if(e)if("undefined"==typeof b.id&&(b.id=d),AV.msie){var f="";for(var g in b)b[g]!=Object.prototype[g]&&("data"==g.toLowerCase()?c.movie=b[g]:"styleclass"==g.toLowerCase()?f+=' class="'+b[g]+'"':"classid"!=g.toLowerCase()&&(f+=" "+g+'="'+b[g]+'"'));var h="";for(var i in c)c[i]!=Object.prototype[i]&&(h+='<param name="'+i+'" value="'+c[i]+'" />');e.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+f+">"+h+"</object>","undefined"==typeof objIdArr&&(objIdArr=[]),objIdArr[objIdArr.length]=b.id}else{var j=document.createElement("object");j.setAttribute("type","application/x-shockwave-flash");for(var k in b)b[k]!=Object.prototype[k]&&("styleclass"==k.toLowerCase()?j.setAttribute("class",b[k]):"classid"!=k.toLowerCase()&&j.setAttribute(k,b[k]));for(var l in c)c[l]!=Object.prototype[l]&&"movie"!=l.toLowerCase()&&a(j,l,c[l]);e.parentNode.replaceChild(j,e)}},c=function(a,c,d,e,f,g,h,i,j){d+="",e+="";var k={};if(j&&"object"==typeof j)for(var l in j)k[l]=j[l];k.data=a,k.width=d,k.height=e;var m={};if(i&&"object"==typeof i)for(var n in i)m[n]=i[n];if(h&&"object"==typeof h)for(var o in h)"undefined"!=typeof m.flashvars?m.flashvars+="&"+o+"="+h[o]:m.flashvars=o+"="+h[o];b(k,m,c)};return function(a,b,d,e,f){f=f||{};var g={};g.quality="high",g.bgcolor="#808080",g.allowscriptaccess="always",g.allowfullscreen="true";var h={};h.id=a,h.name=a,AV.msie&&AV.msie<9&&(h.align="center"),c(b,a+"_replace",d||"100%",e||"100%","10.0.32","",f,g,h)}}(),d=function(){};d.prototype=function(){return{getPlugins:function(){return[]},createCanvas:function(){this.initsize?c(a,AV.build.feather_baseURL+"canvas.swf",this.initsize.width,this.initsize.height):c(a,AV.build.feather_baseURL+"canvas.swf")},_onComponentLoaded:function(b){switch(b){case"canvas":var c=document.getElementById(a);AV.FlashAPI._onCanvasLoaded(c);break;case"controls":}},_onComponentReady:function(a){var b=AV.paintWidgetInstance;"canvas"===a&&b.canvasReadyCallback&&b.canvasReadyCallback.resolve()}}}();var e=function(){var a=[],b=function(){for(var b=0;256>b;b++)a[b]=String.fromCharCode(b);a[0]=String.fromCharCode(1)+String.fromCharCode(1),a[1]=String.fromCharCode(1)+String.fromCharCode(2)},c=function(b){for(var c="",d=0;d<b.length;d+=4)c+=a[b[d+3]],c+=a[b[d]],c+=a[b[d+1]],c+=a[b[d+2]];return c},d=function(a){for(var b,c=[],d=0,e=0,f=[0,0,1];e<a.length;)c[d++]=1!=(b=a.charCodeAt(e++))?b:f[a.charCodeAt(e++)];return c},e={};return e.init=b,e.shutdown=function(){a=[]},e.decode=d,e.encode=c,e}();return function(){var a=!1,c=!1;return{mapToFlashToolName:function(a){switch(a){case"rotate":return"rotate90"}return a},mapFromFlashToolName:function(a){switch(a){case"rotate90":return"rotate"}return a},customBridge:function(a){var b=function(){};b.prototype=new d,b.prototype.constructor=d;for(var c in a)b.prototype[c]=a[c];return b},activate:function(a){this.bridge=a||new d,this.goldenEggCallback=null},setHiresSize:function(a,b){this.canvas&&this.canvas.setHiresSize(a,b)},hiresSizeChanged:function(a,b){AV.paintWidgetInstance&&AV.paintWidgetInstance.actions&&AV.paintWidgetInstance.actions.setDims(a,b)},startEditing:function(a){this.canvas=null,this.active_target=a,this.bridge.createCanvas()},restartEditing:function(a){this.active_target=a,this._setupEditing()},close:function(){},runGoldenEgg:function(a,b,c,d){this.goldenEggCallback=d,this.canvas.renderGoldenEgg(a,b,c)},doCrop:function(){this.canvas.executeCrop()},activatePlugin:function(a){this.canvas.activatePlugin(a)},deactivatePlugin:function(a){this.canvas.deactivatePlugin(a)},changeProperty:function(a,b){this.canvas.changeProperty(a,b)},applyPreviewFromPlugin:function(a){this.canvas.applyPreviewFromPlugin(a)},commitChangesFromPlugin:function(a){this.canvas.commitChangesFromPlugin(a)},discardChangesFromPlugin:function(a){this.canvas.discardChangesFromPlugin(a)},resizeCanvas:function(a,b){var c=this.canvas;c.width=a+"px",c.height=b+"px",AV.paintWidgetInstance&&AV.paintWidgetInstance.setDimensions(a,b)},hideCanvas:function(){this.canvas&&(this.canvas.style.visibility="hidden")},showCanvas:function(){this.canvas&&(this.canvas.style.visibility="visible")},executePlugin:function(){this.canvas.executePlugin()},renderPreview:function(a,b){this.canvas.renderPreview(a,b)},getDynamicPropertyDefaultValue:function(a){return this.canvas.getDynamicPropertyDefaultValue(a)},syncProperty:function(){},syncPreview:function(){},setCanvasDataArray:function(a,b,c){AV.canvasDataReceiver&&AV.canvasDataReceiver.apply(this,[a,b,c])},setThumb:function(){},getHistory:function(){return this.canvas.getHistory()},getHiResStickerUrl:function(a){return AV.paintWidgetInstance&&AV.paintWidgetInstance.overlayRegistry?AV.paintWidgetInstance.overlayRegistry.getHiRes(a):null},getImageData:function(a,c){c&&"function"==typeof c&&(b=c),this.canvas.commit({})},getMaxSize:function(){var a=AV.launchData.maxEditSize||AV.launchData.maxSize;return a},getMaxBitmapSize:function(){return AV.launchData.maxSize},_cropSelectionStarted:function(){},_onPreviewRendered:function(){},_onPluginLoaded:function(a){var b=AV.paintWidgetInstance;b.moduleLoadedCallback&&b.moduleLoadedCallback[a]&&b.moduleLoadedCallback[a].resolve()},_onImageLoaded:function(a,b){AV.paintWidgetLauncher_Flash_stage2&&AV.paintWidgetLauncher_Flash_stage2(a,b)},_onGoldenEggComplete:function(){this.goldenEggCallback&&this.goldenEggCallback()},_onCanvasLoaded:function(a){this.canvas=a,this._setupEditing(AV.launchData.url||null)},_onGetImageDataComplete:function(a){b&&(b.apply(this,[a]),b=null)},_setupEditing:function(a){var b=this.bridge.getPlugins();a=a||this.active_target.src,this.canvas.setup(a,AV.build.proxyServer,b)},_canUndo:function(){return a},_onUndo:function(){this.canvas.undo()},_canRedo:function(){return c},_onRedo:function(){this.canvas.redo()},_onHistoryChange:function(b,d){a=b,c=d,AV.controlsWidgetInstance&&AV.controlsWidgetInstance.layoutNotify(AV.launchData.openType,"updateUndoRedo",[b,d])},setCheckpoint:function(a){this.canvas.setCheckpoint(a)},isACheckpoint:function(a){return this.canvas.isACheckpoint(a)},undoToCheckpoint:function(){this.canvas.undoToCheckpoint()},redoToCheckpoint:function(){return this.canvas.redoToCheckpoint()},truncateActionList:function(){this.canvas.truncateActionList()},_onError:function(a,b){"BAD_IMAGE"===a&&(AV.paintWidgetCloser(!0),AV.launchData.url&&(a="BAD_URL")),AV.errorNotify(a,b)},init:function(a){function b(){if(!a)return new d;if(a.plugins){for(var b=[],c=a.plugins,e=0;e<c.length;++e){var f=AV.FlashAPI.mapToFlashToolName(c[e]),g=AV.toolDefaults[c[e]];g&&g.files&&b.push({id:f,presets:g.presetsFlash,files:g.files})}b.length>0&&(a.getPlugins=function(){return b}),delete a.plugins}var h=function(){};h.prototype=new d,h.prototype.constructor=d;for(var i in a)h.prototype[i]=a[i];return new h}AV.FlashAPI.activate(b()),e.init()},pibeca:e}}()}(),function(a){a.AV=a.AV||{};var b=a.AV;return b.ImageSizeTracker=function(){var a=this;a.setImageScaledIndicator=function(){b.controlsWidgetInstance.layoutNotify(b.launchData.openType,"updateImageScaledIndicator")},a.setOrigSize=function(c,d,e){var f,g;if(c.hiresWidth&&c.hiresHeight)f=parseInt(c.hiresWidth,10),g=parseInt(c.hiresHeight,10);else if(c.hiresUrl)f=d.width,g=d.height;else{if(!c.displayImageSize)return null;f=e.width,g=e.height}return b.paintWidgetInstance.actions.setOrigSize(f,g),a.setImageScaledIndicator(),{width:f,height:g}},a.isDisplayingImageSize=function(a){return a.hiresWidth||a.hiresHeight||a.displayImageSize},a.isUsingHiResDimensions=function(a){return a.hiresWidth||a.hiresHeight||a.displayImageSize&&a.hiresUrl}},a}(this,"undefined"!=typeof window?window:{},"undefined"!=typeof document?document:{}),function(a,b,c){a.AV=a.AV||{};var d=a.AV,e=d.Events;return d.ToolManager=function(a){var f=null,g=function(b){var c,e,f=a.activeTools,g=!1;if(f)for(e=f.length,c=0;e>c;c++)if(f[c]===b){g=!0;break}return g||d.errorNotify("UNSUPPORTED_TOOL",[b]),g},h=function(b,c,d){return a.objectNotify("tool",b,c,d)},i=function(a){null!=a&&(avpw$(".avpw_controlpanel").each(function(){avpw$(this).hide()}),avpw$("#avpw_controlpanel_"+a).show())},j=function(){var c,g=function(g){h(f,"panelWillClose"),h(g,"panelWillOpen"),e.trigger("canvas:activate",a.panelMode2WidgetMode(g)),i(g),h(g,"resetUI"),b.setTimeout(function(a){return function(){h(a,"panelDidClose"),f=g,h(g,"panelDidOpen"),c=!1}}(f),200),f=g,a.layoutNotify(d.launchData.openType,"disableZoomMode")};return function(a){c||(c=!0,g(a))}}(),k=function(b){if(!a.paintWidget||!a.paintWidget.busy){if(a.layoutNotify(d.launchData.openType,"showView",["editpanel"]),j(b),d.controlsWidgetInstance.onEggWaitThrobber.stop(),"mobile"==d.launchData.openType){var e,f=c.getElementById("avpw_main_"+b);f&&(e=f.getAttribute("data-header"),e&&(c.getElementById("avpw_control_toolname").innerHTML=e))}d.usageTracker.addUsage(b)}},l=function(){e.on("tool:open",o),e.on("tool:close",n),e.on("tool:init",p),e.on("tool:shutdown",s),e.on("tool:commit",q),e.on("tool:cancel",r),e.on("tool:undo",x),e.on("tool:redo",y)},m=function(){e.off("tool:open",o),e.off("tool:close",n),e.off("tool:init",p),e.off("tool:shutdown",s),e.off("tool:commit",q),e.off("tool:cancel",r),e.off("tool:undo",x),e.off("tool:redo",y)},n=function(){a.layoutNotify(d.launchData.openType,"showView",["main"]),j(null)},o=function(b,c){b=d.publicName2PanelMode(b),g(b)&&a.paintWidget&&!a.paintWidget.moduleLoaded(b,k)&&c&&(a.onEggWaitThrobber.stop(),a.onEggWaitThrobber.spin(avpw$(c).children(".avpw_icon_waiter")[0])),e.trigger("usage:tool",b,"opened"),e.trigger("usage:firstclick",b)},p=function(b){h(b,"init",[a])},q=function(){var a,b=f;b&&(a=h(f,"commit"),a!==!1&&(e.trigger("usage:tool",b,"applied",a!==!0?a:""),e.trigger("tool:commitDone")))},r=function(){h(f,"cancel"),e.trigger("usage:tool",f,"canceled")},s=function(a){h(a,"shutdown")},t=function(){return a.paintWidget.busy?!1:h(f,"onUndo")===!1?!1:(a.paintWidget.actions.undo(),h(f,"onUndoComplete"),!1)},u=function(){return a.paintWidget.busy?!1:h(f,"onUndo",[{global:!0}])===!1?!1:(a.paintWidget.actions.undoToCheckpoint(),h(f,"onUndoComplete",[{global:!0}]),!1)},v=function(){return a.paintWidget.busy?!1:h(f,"onRedo")===!1?!1:(a.paintWidget.actions.redo(),h(f,"onRedoComplete"),!1)},w=function(){if(a.paintWidget.busy)return!1;if(h(f,"onRedo",[{global:!0}])===!1)return!1;var b=a.paintWidget.actions.redoToCheckpoint();return b&&h(f,"onRedoComplete",[{global:!0}]),b},x=function(){e.trigger("usage:tool","undo","applied",f||""),a.paintWidget.actions.isACheckpoint()?u():t()},y=function(){e.trigger("usage:tool","redo","applied",f||""),w()||v()},z=this;return z.init=l,z.shutdown=m,z.notify=h,z.getActiveTool=function(){return f},l(),z},a}(this,"undefined"!=typeof window?window:{},"undefined"!=typeof document?document:{}),function(a,b){a.AssetManager=function(c,d){"use strict";var e,f={EFFECT:"effect",STICKER:"sticker",IMAGEBORDER:"imageborder",PERMISSION:"permission"},g={},h=function(){b.avpw_purchase_frame||avpw$("#avpw_messaging").append(a.template[a.launchData.layout].inAppPurchaseFrame({src:a.build.inAppPurchaseFrameURL}))},i=function(b){var c=b.resourceUrl;c&&(-1===c.indexOf("http")&&(c=a.build.feather_baseURL+c),b.resourceUrl=c)},j=function(b){for(var c=0;c<e.length;c++)for(var d=0;d<b.length;d++)b[d].assetId===e[c].assetId&&(e[c].purchased=!0,a.util.extend(e[c],b[d]),i(e[c]))},k=function(a){var b=[];if(a){a=f[a];for(var c=0;c<e.length;c++)e[c].assetType===a&&b.push(e[c])
}else b=e.slice(0);return b},l=function(b,c){e?c&&c.apply(this,[k(b)]):(g.getPartnerAssets||(g.getPartnerAssets=[],r.authenticate()),g.getPartnerAssets.push(function(d){d&&d.assets?e=d.assets:(a.errorNotify("ERROR_AUTHENTICATING"),o()),a.util.nextFrame(function(){if(e){for(var a=0;a<e.length;a++)i(e[a]);c&&c.apply(this,[k(b)])}})}))},m=function(a,c){b.setTimeout(function(){try{return b.avpw_purchase_frame.postMessage("getAssets","*"),g.getAssets=c,!0}catch(a){return!1}},2e3)},n=function(a,c){if(!e)return m(a,function(b){e=b;for(var d=0;d<e.length;d++)i(e[d]);q(a,c)}),!1;try{return b.avpw_purchase_frame.postMessage("getPurchasedAssets","*"),g.getPurchasedAssets=function(b){j(b),c&&c.apply(this,[k(a)])},!0}catch(d){return!1}},o=function(b,c){return e=[{needsPurchase:!1,assetId:"default_effects",assetType:"effect",displayName:"Default",resourceUrl:"js/proclist_default_effects.js"},{needsPurchase:!1,assetId:"original_effects",assetType:"effect",displayName:"Original",resourceUrl:"js/proclist_original_effects.js"},{needsPurchase:!1,assetId:"original_stickers",assetType:"sticker",displayName:"Original",resourceUrl:"js/stickers_original_stickers.js"},{needsPurchase:!1,assetId:"borders",assetType:"imageborder",displayName:"Default Image Borders",resourceUrl:"js/borders_original.js"}],c&&a.util.nextFrame(function(){for(var a=0;a<e.length;a++)i(e[a]);c.apply(this,[k(b)])}),!0},p=function(a){var b,c,d;if(a.messageName&&(d=g[a.messageName])){if("function"==typeof d)d.apply(this,[a.data]);else for(c=d.length,b=0;c>b;b++)d[b].apply(this,[a.data]);d=null}},q=c?l:d?n:o,r=this;return r.getAssets=q,r.getById=function(a){for(var b=0;b<e.length;b++)if(e[b].assetId===a)return e[b]},r.showAssetPurchaseView=function(c,d){var e={messageName:"showAssetPurchaseView",assetId:c};e=a.JSON.stringify(e);try{return b.avpw_purchase_frame.postMessage(e,"*"),g.showAssetPurchaseView=function(){r.showAssetPurchasePopup(c,d)},!0}catch(f){return!1}},r.showAssetPurchasePopup=function(b,c){avpw$("#avpw_purchase_frame").show(),a.controlsWidgetInstance.messager.show("avpw_purchase_pack",!0),avpw$("#avpw_purchase_pack_close").bind("click",r.hideAssetPurchasePopup),g.getPurchasedAssets=function(a){j(a);var d=r.getById(b);c&&"function"==typeof c&&d&&c.apply(this,[d]),r.hideAssetPurchasePopup()}},r.hideAssetPurchasePopup=function(){g.getPurchasedAssets=null,avpw$("#avpw_purchase_frame").hide(),a.controlsWidgetInstance.messager.hide("avpw_purchase_pack"),avpw$("#avpw_purchase_pack_close").unbind("click",r.hideAssetPurchasePopup)},r.authenticate=function(){var b=function(a){var b={messageName:"getPartnerAssets",data:a};p(b)};return function(){return a.controlsWidgetInstance.serverMessaging.sendMessage({id:"avpw_auth_form",action:a.build.partnerAssetURL,method:"POST",dataType:"json",announcer:a.build.asyncFeatherTargetAnnounce,origin:a.build.asyncImgrecvBase,keyValues:{apikey:a.launchData.apiKey,timestamp:a.launchData.timestamp,signature:a.launchData.signature,salt:a.launchData.salt,encryptionmethod:a.launchData.encryptionMethod},callback:b})}}(),r.types=f,d&&h(),r}}(window.AV||(window.AV={}),window,document),function(a,b,c){a.ServerMessaging=function(){var d=[],e=function(b,c){var e,f,g=!0,h=d.shift();if(h&&(c&&h.origin&&(g=c===a.util.getDomain(h.origin)),h.id&&(e=avpw$("#"+h.id),f=e.attr("target"),avpw$("#"+f).unbind("load"),avpw$("#"+h.id+"_target_holder").empty(),e.remove()),g&&h.callback)){if(h.dataType&&"json"===h.dataType&&"string"==typeof b)try{b=a.JSON.parse(b)}catch(i){}h.callback.call(this,b)}d.length>0&&m()},f=function(b,c,d,e,f){return avpw$.ajax({url:b,type:c,data:d,dataType:e,error:function(){a.errorNotify("ERROR_SAVING",[a.build.imgrecvServer])},success:f})},g=function(a,b,d,e,f){var g=avpw$("<form></form>").attr({id:a,action:b,target:d,method:e||"POST"}).css({display:"none"}),h=c.createDocumentFragment();for(var i in f)f.hasOwnProperty(i)&&h.appendChild(avpw$("<input></input>").attr({name:i,value:f[i],type:"hidden"})[0]);return g.html(h),g.appendTo("#avpw_holder"),g},h=function(b,c,d){return d||(d=a.build.feather_baseURL+"blank.html"),c||(c=b),['<iframe width="1" height="1" ','style="position:absolute;left:-9999px;" ','id="'+b+'" name="'+c+'" src="'+d+'">',"</iframe>"].join("")},i=function(a,b,c){if(!a)return null;var d=a+"_target_holder",e=Math.floor(4294967295*Math.random()).toString(16),f="avpw_form_target_"+e,g=avpw$("#"+d);return g&&g.length||(g=avpw$('<div id="'+d+'"></div>').css({position:"absolute",top:0,left:0}).appendTo("#avpw_holder")),g.html(h(f)),avpw$("#"+f).load(b?function(){k(f,a,b)}:c),f},j=function(a,b,c,d,e,f,h){var j=i(a,f,h);b+="?responsecontenttypeheader="+escape("text/html");var k=g(a,b,j,c,e);return k.submit(),k},k=function(c,d,f){var g,i=d+"_announcer";if(b.postMessage)b[i]?b[i].postMessage("avpw_load:"+c,"*"):(g=avpw$(h(i,i,f)),g.load(function(){a.util.nextFrame(function(){b[i].postMessage("avpw_load:"+c,"*")})}),avpw$("#avpw_holder").append(g));else{var j,k=function(){avpw$(j).unbind().remove()},l=d+"_observer",m=l,n=0,o=function(){var b;try{if("about:blank"==j.contentWindow.location)return}catch(c){}2===n&&(b=j.contentWindow.name,b&&(n=3,b!==m&&b.substr&&"avpw:"==b.substr(0,5)?(b=b.substr(5),e(b)):(a.errorNotify("ERROR_SAVING",[a.build.imgrecvServer]),e()),k())),1===n&&(n=2,j.contentWindow.location=""),n||(n=1)};j=avpw$(h(l,m,f+"#"+c))[0],avpw$(j).load(o),avpw$(j).appendTo("#avpw_holder")}},l=function(b){var c=b.data,d=a.util.getDomain(b.origin);c.substr&&"avpw:"==c.substr(0,5)&&(c=c.substr(5),e(c,d))},m=function(){var a=d[0];a&&j(a.id,a.action,a.method,a.origin,a.keyValues,a.announcer)},n=function(a){a.announcer?(d.push(a),1===d.length&&m()):j(a.id,a.action,a.method,a.origin,a.keyValues,a.announcer,a.callback)},o=function(b){var c,d=b.transport||"xhr";"xhr"===d&&avpw$.support.cors&&(!a.firefox||a.firefox>=4)?(c=f(b.action,b.method,b.keyValues,b.dataType,b.callback),c||n(b)):n(b)},p=function(){b.addEventListener?b.addEventListener("message",l,!1):b.attachEvent&&b.attachEvent("onmessage",l)},q=this;return q.shutdown=function(){b.removeEventListener?b.removeEventListener("message",l,!1):b.detachEvent&&b.detachEvent("onmessage",l),d=[]},q.sendMessage=o,p(),q}}(window.AV||(window.AV={}),window,document),function(a,b,c){a.AV=a.AV||{};var d=a.AV,e=d.Events;return d.usageTracker=function(){var a,f=null,g={},h=0,i=[],j=0,k=-1,l=1,m=!1,n={},o=function(){d.controlsWidgetInstance&&n.submit("close")},p=function(){if(b._gaq=b._gaq||[],"undefined"==typeof _gat){var a=c.createElement("script");a.type="text/javascript",a.async=!0,a.src=("https:"==c.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var e=c.getElementsByTagName("script")[0];e.parentNode.insertBefore(a,e)}m||(_gaq.push(["Feather._setAccount",d.build.googleTracker]),_gaq.push(["Feather._setCustomVar",1,"apikey",d.launchData.apiKey]),_gaq.push(["Feather._setCustomVar",2,"featherversion",d.build.version]),_gaq.push(["Feather._setCustomVar",3,"sessionid",this.getUUID()]),_gaq.push(["Feather._setCustomVar",4,"language",d.launchData.language]),_gaq.push(["Feather._setCustomVar",5,"apiversion",d.launchData.apiVersion+""]),m=!0)},q=function(a,b,c){_gaq.push(["Feather._trackEvent","tool",a+":"+b,c?c+"":""])},r=function(a,b,c){_gaq.push(["Feather._trackEvent","interaction",a+":"+b,c?c+"":""])},s=function(a){n.submit("firstclick",a),e.off("usage:firstclick")};return n.setup=function(){avpw$(b).bind("unload",o),e.on("usage:submit",n.submit,n),e.on("usage:tool",q,n),e.on("usage:firstclick",s,n),e.on("usage:interact",r)},n.shutdown=function(){avpw$(b).unbind("unload",o),e.off("usage:submit",n.submit),e.off("usage:tool",q),e.off("usage:firstclick",s),e.off("usage:interact",r)},n.clear=function(){f=null,g={},h=0,i=[],j=0,k=-1},n.getUUID=function(){return f?f:f=Math.floor(4294967295*Math.random()).toString(16)+Math.floor(4294967295*Math.random()).toString(16)},n.addUsage=function(a,b){b||(b=1),void 0===g[a]?g[a]=b:g[a]+=b,h+=b},n.setPageCount=function(a){var b;for(j=a,i=new Array(a),b=0;a>b;b++)i[b]=0},n.addPageHit=function(b){b!==a&&i[b]++,a=b},n.submit=function(a,b){var c,e=null,f="";if(p.call(this),_gaq.push("launch"===a?["Feather._trackPageview"]:["Feather._trackEvent","submit",a,b]),d.controlsWidgetInstance&&d.build.imgtrackServer&&d.JSON){switch(a){case"close":e={dataver:l,opentype:d.launchData.openType,pagehits:i,toolusage:g},f=d.JSON.stringify(e);break;case"firstclick":e={toolusage:g},f=d.JSON.stringify(e)}c=d.controlsWidgetInstance.serverMessaging.sendMessage({id:"avpw_track_form",action:d.build.imgtrackServer,method:"GET",keyValues:{action:a,sessionid:this.getUUID(),featherversion:d.build.version,apikey:d.launchData.apiKey,toolusagedata:f},callback:function(){d.util.nextFrame(function(){var a=avpw$("#avpw_track_form_target_holder");if(a&&a.length&&a.empty(),c){var b=c.attr("target");avpw$("#"+b).unbind("load"),c.remove()}})},transport:"form"})}},n}(),d.getActiveTools=function(a){var b=d.featherUseFlash?d.flashSupportedTools:d.defaultTools,c=a;c&&"all"!==c&&"All"!==c&&"ALL"!==c&&""!==c||(c=b),"string"==typeof c&&(c=a.split(","));var e,f,g=[],h={};for(f=0;f<b.length;f++)e=b[f],h[e]=!0;for(f=0;f<c.length;f++)e=d.publicName2PanelMode(c[f]),e in h&&g.push(e);return g},d.paintWidgetGetPopupEmbedDiv=function(a){var b=avpw$("#avpw_canvas_embed_popup");if(a){var d,e,f,g=avpw$(a),h=["top","left","bottom","right","margin-top","margin-right","margin-bottom","margin-left","border-top","border-right","border-bottom","border-left","padding-top","padding-right","padding-bottom","padding-left"],i={position:"relative"};for(e=0;e<h.length;e++)f=h[e],i[f]=g.css(f);d=avpw$(a).css("display"),(""==d||"inline"==d)&&(d="inline-block"),i.display=d,0==b.length&&(b=c.createElement("div"),b.id="avpw_canvas_embed_popup"),avpw$(b).hide().css(i).insertBefore(a)}return b},d.paintWidgetLauncher=function(a,b){return d.paintWidgetInstance?void 0:(d.usageTracker.clear(),d.featherUseFlash?d.paintWidgetLauncher_Flash(a,b):d.paintWidgetLauncher_HTML(a,b))},d.paintWidgetLauncher_Flash=function(a,f){function g(){avpw$(i).unbind("load",g),d.msie&&7==d.msie&&(avpw$("#avpw_controls").css("visibility","hidden"),avpw$("#avpw_controls").show()),d.controlsWidgetInstance.layoutNotify(d.launchData.openType,"placeControls_Flash",[2===d.util.getApiVersion(d.launchData)?d.launchData.appendTo:void 0]),d.controlsWidgetInstance.layoutNotify(d.launchData.openType,"enableControls"),k=d.controlsWidgetInstance.layoutNotify(d.launchData.openType,"getScaledImageDims_Flash",[i]),l=k.width,m=k.height,n=l>m?l:m,d.launchData.maxEditSize=n,d.paintWidgetInstance=new d.PaintWidget(l,m,new d.Actions,new d.ModeManager,new d.FilterManager,new d.OverlayRegistry,new d.ImageBorderManager),d.paintWidgetInstance.setOrigSize(l,m);var c=d.template[d.launchData.layout].flashCanvasBox({id:"avpw_canvas_swf_replace"});avpw$(j).append(c),d.controlsWidgetInstance.initAllTools.call(d.controlsWidgetInstance);var h={initsize:k,plugins:p,action:{origUrl_:f?f:s.src,sessionID_:d.usageTracker.getUUID(),referrerUrl_:b.location.href,url:d.build.imgrecvServer,name:"file"}};d.controlsWidgetInstance.layoutNotify(d.launchData.openType,"hideOriginalImage",[s]),d.util.nextFrame(function(){d.controlsWidgetInstance.setupScrollPanels()}),d.msie&&7==d.msie&&(avpw$("#avpw_controls").hide(),avpw$("#avpw_controls").css("visibility","visible")),avpw$("#avpw_controls").fadeIn(r),d.launchData.noCloseButton&&avpw$("#avpw_control_cancel_pane").css("display","none");setTimeout(function(){d.FlashAPI.init(h),d.FlashAPI.startEditing(a),d.controlsWidgetInstance.initWithPaintWidget(d.paintWidgetInstance),e.trigger("tool:close"),d.controlsWidgetInstance.loaderPhase=1},r)}function h(){d.util.imgOnLoad(i,g),avpw$(i).attr("src",f?f:t)}var i,j,k,l,m,n,o,p,q,r=d.launchData.launchDelay,s=d.util.getImageElem(a),t=s.src;p=d.getActiveTools(d.launchData.tools),q=new d.AssetManager(d.launchData.isPremiumPartner,d.launchData.allowInAppPurchase),d.controlsWidgetInstance=new d.ControlsWidget(null,a,p,q,new d.ServerMessaging),d.controlsWidgetInstance.origURL=f?f:avpw$(s).attr("src"),avpw$(".avpw_isa_previewcanvas").hide(),j=d.controlsWidgetInstance.layoutNotify(d.launchData.openType,"getEmbedElement",[s]),avpw$(j).show(),o="js/featherpaint_flash.js",i=c.createElement("img"),avpw$(i).css({display:"block",visibility:"hidden",position:"absolute"}).attr("src",f?f:s.src),d.build.bundled?h():d.util.loadFile(d.build.feather_baseURL+o,"js",h)},d.paintWidgetLauncher_Flash_stage2=function(a,b){d.controlsWidgetInstance.loaderPhase=2,d.controlsWidgetInstance.imageSizeTracker.setOrigSize(d.launchData,{width:a,height:b},{width:d.paintWidgetInstance.width,height:d.paintWidgetInstance.height}),d.controlsWidgetInstance.layoutNotify(d.launchData.openType,"launchStage2_Flash"),d.controlsWidgetInstance.showWaitThrobber(!1),avpw$(d.controlsWidgetInstance.onEggWaitThrobber).hide(),e.trigger("usage:submit","launch"),d.fireLaunchComplete()},d.paintWidgetLauncher_HTML=function(a,b){var e,f,g,h,i,j,k=d.launchData.launchDelay,l=d.util.getImageElem(a);return i=d.getActiveTools(d.launchData.tools),d.isRelaunched&&"undefined"!=typeof l.avpw_prevURL&&(b=l.avpw_prevURL),j=new d.AssetManager(d.launchData.isPremiumPartner,d.launchData.allowInAppPurchase),d.controlsWidgetInstance=new d.ControlsWidget(null,a,i,j,new d.ServerMessaging),d.controlsWidgetInstance.origURL=b?b:avpw$(l).attr("src"),d.controlsWidgetInstance.layoutNotify(d.launchData.openType,"placeControls",[2===d.util.getApiVersion(d.launchData)?d.launchData.appendTo:void 0]),d.controlsWidgetInstance.layoutNotify(d.launchData.openType,"enableControls"),avpw$("#avpw_controls").fadeIn(k),d.util.nextFrame(function(){"mobile"==d.launchData.openType&&d.setPageWidth(avpw$("#avpw_controls").width()),d.controlsWidgetInstance.setupScrollPanels()}),d.launchData.noCloseButton&&avpw$("#avpw_control_cancel_pane").css("display","none"),l&&"canvas"===l.nodeName.toLowerCase()?void d.mockLauncher(l):(g="js/featherpaint.js",f=d.controlsWidgetInstance.layoutNotify(d.launchData.openType,"getEmbedElement",[l]),e=c.createElement("img"),e.id="avpw_temp_loading_image",d.tempLoadingImageSrc=e.src,avpw$(e).load(function(){h=d.controlsWidgetInstance.getScaledDims(avpw$(l).width(),avpw$(l).height()),e.width=h.width,e.height=h.height,d.controlsWidgetInstance.layoutNotify(d.launchData.openType,"getScaledImageDims",[e]),avpw$(e).unbind(),e.style.display="block",avpw$(f).append(e),d.controlsWidgetInstance.showWaitThrobber(!0),d.controlsWidgetInstance.layoutNotify(d.launchData.openType,"hideOriginalImage",[l]),avpw$(f).show(),d.util.nextFrame(function(){d.build.bundled?d.paintWidgetLauncher_stage2(a,b):d.util.loadFile(d.build.feather_baseURL+g,"js",function(){d.paintWidgetLauncher_stage2(a,b)})})}).error(function(){d.paintWidgetCloser(!0),d.errorNotify("BAD_IMAGE",[b])}),e.src=l.src,!1)},d.mockLauncher=function(a){var b=d.controlsWidgetInstance.layoutNotify(d.launchData.openType,"getEmbedElement",[a]);d.controlsWidgetInstance.layoutNotify(d.launchData.openType,"getScaledImageDims",[a]),avpw$(a).detach(),avpw$(b).append(a),avpw$(b).show(),d.controlsWidgetInstance.showWaitThrobber(!0),d.util.nextFrame(function(){var a=function(){};d.controlsWidgetInstance.initAllTools=function(){for(var a in this.activeTools){var b=this.activeTools[a];this.tool.hasOwnProperty(b)&&e.trigger("tool:init",b)}},d.controlsWidgetInstance.initWithPaintWidget=function(a){this.paintWidget=a,this.initAllTools(),this.bindControls(),this.paintWidget.showWaitThrobber=this.showWaitThrobber.AV_bindInst(this)},d.controlsWidgetInstance.loaderPhase=1,d.paintWidgetInstance={moduleLoaded:function(a,b){return b.call(this)},setMode:a,setCurrentLayerByName:a,shutdown:a,actions:{setCheckpoint:a}},d.controlsWidgetInstance.initWithPaintWidget(d.paintWidgetInstance),d.controlsWidgetInstance.showWaitThrobber(!1),d.controlsWidgetInstance.loaderPhase=2,d.fireLaunchComplete()})},d.paintWidgetLauncher_stage2=function(a,b){var c,f,g=d.util.getImageElem(a),h=function(a){d.controlsWidgetInstance&&d.paintWidgetInstance&&(c=new Image,avpw$(c).load(function(){if(d.controlsWidgetInstance&&d.paintWidgetInstance){if(f=d.controlsWidgetInstance.getScaledDims(c.width,c.height),d.controlsWidgetInstance.imageSizeTracker.setOrigSize(d.launchData,c,f),c.width=f.width,c.height=f.height,d.paintWidgetInstance.setDimensions(f.width,f.height),!d.paintWidgetInstance.setBackground(c))return d.paintWidgetCloser(!0),d.errorNotify("IMAGE_NOT_CLEAN",[b]),!1;d.paintWidgetInstance.setOrigSize(f.width,f.height),g.src!==b&&d.controlsWidgetInstance.layoutNotify(d.launchData.openType,"scaleCanvas"),avpw$(d.paintWidgetInstance.canvas).insertBefore("#avpw_temp_loading_image"),i.remove(),d.tempLoadingImageSrc=b,d.controlsWidgetInstance.showWaitThrobber(!1),d.controlsWidgetInstance.loaderPhase=2,d.launchData.actionListJSON&&d.paintWidgetInstance.actions.importJSON(d.launchData.actionListJSON,d.fireLaunchComplete)}}).attr("src",a))};f=d.controlsWidgetInstance.getScaledDims(avpw$(g).width(),avpw$(g).height()),d.controlsWidgetInstance.loaderPhase=1,d.paintWidgetInstance=new d.PaintWidget(f.width,f.height,new d.Actions,new d.ModeManager,new d.FilterManager,new d.OverlayRegistry,new d.ImageBorderManager),d.controlsWidgetInstance.canvasUI=new d.PaintUI(d.paintWidgetInstance.canvas,d.controlsWidgetInstance.layoutNotify(d.launchData.openType,"getEmbedElement")),d.controlsWidgetInstance.initWithPaintWidget(d.paintWidgetInstance),d.paintWidgetInstance.setOrigSize(f.width,f.height),d.controlsWidgetInstance.imageSizeTracker.setOrigSize(d.launchData,g,f);var i=avpw$("#avpw_temp_loading_image");if(d.controlsWidgetInstance.layoutNotify(d.launchData.openType,"scaleCanvas"),null!=b)-1===b.indexOf("data:")?avpw$.ajax({type:"GET",dataType:"json",url:d.build.jsonp_imgserver+"?callback=?",data:{url:escape(b)},success:function(a){h(a.data)},error:function(a,c){200===a.status&&"parsererror"===c&&d.controlsWidgetInstance&&(d.controlsWidgetInstance.showWaitThrobber(!1),d.util.nextFrame(function(){d.paintWidgetCloser(!0),d.errorNotify("BAD_URL",[b])}))}}):h(b);else{if(!d.paintWidgetInstance.setBackground(g))return d.paintWidgetCloser(!0),d.errorNotify("IMAGE_NOT_CLEAN",[b]),!1;avpw$("#avpw_controls").insertAfter(d.paintWidgetInstance.canvas),avpw$(d.paintWidgetInstance.canvas).insertBefore(i),i.remove(),d.tempLoadingImageSrc=g.src,d.controlsWidgetInstance.showWaitThrobber(!1),d.controlsWidgetInstance.loaderPhase=2,d.launchData.actionListJSON&&d.paintWidgetInstance.actions.importJSON(d.launchData.actionListJSON,d.fireLaunchComplete)}return e.trigger("usage:submit","launch"),d.launchData.actionListJSON||d.fireLaunchComplete(),!1},d.fireLaunchComplete=function(){var a=d.launchData.initTool;a&&d.util.nextFrame(function(){e.trigger("tool:open",a)}),"function"==typeof d.launchData.onReady&&d.launchData.onReady()},d.paintWidgetShutdown=function(){e.trigger("usage:submit","close"),d.paintWidgetInstance&&d.paintWidgetInstance.shutdown(),d.controlsWidgetInstance&&(d.controlsWidgetInstance.serverMessaging&&(d.controlsWidgetInstance.serverMessaging.shutdown(),d.controlsWidgetInstance.serverMessaging=null),d.controlsWidgetInstance.shutdown()),d.featherUseFlash&&d.FlashAPI.close(),avpw$("#avpw_controls").hide(),d.controlsWidgetInstance.layoutNotify(d.launchData.openType,"onShutdown"),"function"==typeof d.launchData.onClose&&d.launchData.onClose(d.paintWidgetInstance.dirty),d.paintWidgetInstance=null,d.controlsWidgetInstance=null,d.tempLoadingImageSrc=null},d.paintWidgetCloser=function(a){var b=d.launchData.closeDelay;d.controlsWidgetInstance.layoutNotify(d.launchData.openType,"onClose",[a]),a||0===b?(avpw$("#avpw_controls").hide(),d.paintWidgetShutdown()):avpw$("#avpw_controls").fadeOut(b,function(){d.paintWidgetInstance&&d.paintWidgetShutdown()})},d.controlsWidget_saveResponder=function(a,b,c){var f;if("function"==typeof a&&(f=a.apply(d.launchData,[d.util.getImageId(d.controlsWidgetInstance.paintImgIdElem),b,c])),d.controlsWidgetInstance){var g=d.util.getImageElem(d.controlsWidgetInstance.paintImgIdElem);g.avpw_prevURL=b,e.trigger("tool:close"),f!==!1&&d.controlsWidgetInstance.messager.show("avpw_aviary_beensaved",!0),d.controlsWidgetInstance.paintWidget.dirty=!1,d.controlsWidgetInstance.saving=!1}},d.controlsWidget_onImageSaved=function(a,b){d.controlsWidget_saveResponder(d.launchData.onSave,a,b)},d.controlsWidget_onHiResImageSaved=function(a){d.controlsWidget_saveResponder(d.launchData.onSaveHiRes,a)},d.ControlsWidget=function(a,b,c,f,g){this.maxWidth=parseInt(d.launchData.maxSize),this.maxHeight=this.maxWidth,this.saving=!1,this.origURL=null,this.activeTools=c,this.quitCount=0,d.usageTracker.setup(),this.paintImgIdElem=b,e.on("layout:resize",this.setupScrollPanels,this),this.layoutNotify(d.launchData.openType,"showView",["main"]),a&&this.initWithPaintWidget(a);var h={className:"avpw_canvas_spinner",lines:12,length:6,width:2,radius:6,color:"#fff",speed:.5,trail:70},i={className:"avpw_tool_spinner",lines:12,length:6,width:2,radius:6,color:"#fff",speed:.5,trail:70};"mobile"!=d.launchData.openType&&(i.color="#555",i.length=4),this.waitThrobber=new d.Spinner(h),this.onEggWaitThrobber=new d.Spinner(i),this.toolManager=new d.ToolManager(this),this.assetManager=f,this.serverMessaging=g},d.ControlsWidget.prototype.tool={},d.ControlsWidget.prototype.layout={},d.ControlsWidget.prototype.layoutNotify=function(a,b,c){return this.objectNotify("layout",a,b,c)},d.ControlsWidget.prototype.objectNotify=function(a,b,c,d){if("object"==typeof this[a][b]){var e=this[a][b];if("function"==typeof e[c]){var f=e[c];return d||(d=[]),f.apply(e,d)}}return!0},d.ControlsWidget.prototype.shutdown=function(){this.canvasUI&&this.canvasUI.shutdown(),this.messager&&this.messager.hide(),e.off("layout:resize",this.setupScrollPanels),this.shutdownAllTools(),this.unbindControls(),this.toolsPager&&(this.toolsPager.shutdown(),this.toolsPager=null),this.paintWidget&&(this.paintWidget.showWaitThrobber=null),d.usageTracker.shutdown(),this.waitThrobber.stop(),this.onEggWaitThrobber.stop(),this.waitThrobber=null,this.onEggWaitThrobber=null,this.showPanel(null),this.toolManager.shutdown(),this.toolManager=null},d.ControlsWidget.prototype.initAllTools=function(){d.paintWidgetInstance.filterManager.loadPack("tools");for(var a in this.activeTools){var b=this.activeTools[a];this.tool.hasOwnProperty(b)&&d.paintWidgetInstance.moduleLoaded(b,function(a){e.trigger("tool:init",a)}.AV_bindInst(this))}},d.ControlsWidget.prototype.shutdownAllTools=function(){for(var a in this.activeTools){var b=this.activeTools[a];e.trigger("tool:shutdown",b)}},d.ControlsWidget.prototype.bindControls=function(){},d.ControlsWidget.prototype.unbindControls=function(){},d.ControlsWidget.prototype.initWithPaintWidget=function(a){this.paintWidget=a,this.imageSizeTracker=new d.ImageSizeTracker(a.actions),d.featherUseFlash||this.initAllTools(),this.bindControls(),this.paintWidget.showWaitThrobber=this.showWaitThrobber.AV_bindInst(this)},d.ControlsWidget.prototype.showWaitThrobber=function(a,c){var e=300,f=this;if(a){var g=this.layoutNotify(d.launchData.openType,"getEmbedElement");g.is(":visible")&&(this.waitThrobber.spin(g[0]),avpw$(this.waitThrobber).fadeIn(e))}else avpw$(f.waitThrobber.el).fadeOut(e,f.waitThrobber.stop);c&&b.setTimeout(c,5)},d.publicName2PanelMode=function(a){return"stickers"===a&&(a="overlay"),"draw"===a&&(a="drawing"),"text"!==a||d.featherUseFlash||(a="textwithfont"),a},d.ControlsWidget.prototype.panelMode2WidgetMode=function(a){switch(a){case"rotate":return"rotate90";case"greeneye":return"redeye";case"pinch":return"bulge"}return a},d.ControlsWidget.prototype.setupScrollPanels=function(){if(this.activeTools&&this.activeTools.length){var a,b,c,e=this,f={},g=this.layoutNotify(d.launchData.openType,"getDims").TOOLS_BROWSER_WIDTH,h=function(){e.toolsPager=new d.Pager(i)},i={itemCount:this.activeTools.length,itemsPerPage:this.layoutNotify(d.launchData.openType,"getToolsPerPage"),pageWidth:g,leftArrow:avpw$("#avpw_lftArrow"),rightArrow:avpw$("#avpw_rghtArrow"),itemBuilder:function(c){return a=e.activeTools[c],b="overlay"==a?d.getLocalizedString("Stickers"):"barrel"==a?d.getLocalizedString("Bulge"):"drawing"==a?d.getLocalizedString("Draw"):"textwithfont"==a?d.getLocalizedString("Text"):"colorsplash"==a?d.getLocalizedString("Splash"):"tiltshift"==a?d.getLocalizedString("Tilt Shift"):a.substr(0,1).toUpperCase()+a.substr(1),b=d.getLocalizedString(b),d.template[d.launchData.layout].eggIcon({optionName:a,capOptionName:b})},pageTemplate:d.template[d.launchData.layout].genericScrollPanel,pipTemplate:d.template[d.launchData.layout].scrollPanelPip,lastPageTemplate:c,lastPageContents:f,pageContainer:avpw$("#avpw_control_main_scrolling_region"),pipContainer:avpw$("#avpw_tools_pager ul"),onPageChange:function(a){d.usageTracker.addPageHit(a)}};h(),avpw$("#avpw_control_main_scrolling_region").css("width",e.toolsPager.getPageCount()*g+"px"),this.assetManager.getAssets("PERMISSION",function(a){var b=!0;if(a)for(var c=0;c<a.length;c++)if(a[c]&&"whitelabel"===a[c].assetId){b=!1;break}b&&(i.lastPageTemplate=d.template[d.launchData.layout].aviaryScrollPanel,i.lastPageContents={panelWidth:g,panelClass:"avpw_scroll_page_complete"},avpw$("#avpw_powered_branding").html(d.template[d.launchData.layout].poweredByFooterLogo),e.toolsPager.shutdown(),h(),avpw$("#avpw_control_main_scrolling_region").css("width",e.toolsPager.getPageCount()*g+"px"),e.toolsPager.changePage())}),d.usageTracker.setPageCount(e.toolsPager.getPageCount()),e.toolsPager.changePage()}},d.ControlsWidget.prototype.messager=function(){var a,c,e,f={},g=1e3;return{show:function(e,h,i){a=a||avpw$("#avpw_messaging"),c=c||avpw$("#avpw_messaging_inner");var j=f[e]||(f[e]=avpw$("#"+e));c.append(j),a.show(),h?(a.data("needsConfirmation",!0),d.controlsWidgetInstance.layoutNotify(d.launchData.openType,"disableControls")):(a.data("needsConfirmation",!1),i||b.setTimeout(this.hide,g))},hide:function(c,g){if(a=a||avpw$("#avpw_messaging"),e=e||avpw$("#avpw_messages"),c){var h=f[c];h&&e.append(h)}else avpw$.each(f,function(a,b){e.append(b)});a.data("needsConfirmation")?(b.setTimeout(function(){g&&g()},400),d.controlsWidgetInstance&&d.controlsWidgetInstance.layoutNotify(d.launchData.openType,"enableControls")):(a.hide(),g&&g())},addMessage:function(a){e=e||avpw$("#avpw_messages"),a&&(e[0].innerHTML+=a)}}}(),d.ControlsWidget.prototype.orientationChanged=function(){},d.ControlsWidget.prototype.windowResized=function(){var a=null;return function(){b.clearTimeout(a),a=b.setTimeout(function(){e.trigger("layout:resize"),a=null},500)}}(),d.ControlsWidget.prototype.Slider=function(a){var b=!1,c=function(c,d){!b&&a.onstart&&a.onstart.apply(this,[c,d])},d=function(c,d){!b&&a.onchange&&a.onchange.apply(this,[c,d])},e=function(c,d){!b&&a.onslide&&a.onslide.apply(this,[c,d])},f=avpw$(a.element).slider({range:"min",max:a.max,min:a.min,value:a.defaultValue||a.max/2,delay:a.delay});return this.getValue=function(){return f.slider("value")},this.setValue=function(a){return f.slider("value",a)},this.reset=function(){b=!0,this.setValue(a.defaultValue),b=!1},this.addListeners=function(){f.bind("slidestart",c).bind("slidechange",d).bind("slide",e)},this.removeListeners=function(){f.unbind("slidestart").unbind("slide").unbind("slidechange")},this.shutdown=function(){f.slider("destroy")},this},d.ControlsWidget.prototype._drawUICircle=function(a,b,c,e,f){d.featherUseFlash||this._drawUICircle_HTML(a,b,c,e,f)},d.ControlsWidget.prototype._drawUICircle_HTML=function(a,b,c,e,f){var g,h=avpw$(a)[0],i=h.getContext("2d");i.clearRect(0,0,h.width,h.height),f&&"transparent"!==e&&this._drawUIGrid(i,h.width,h.height),i.globalCompositeOperation="source-over",null!=c?(i.strokeStyle=f&&("transparent"==c||d.util.color_is_white(c)||null==e)?"#444":c,g=3):(i.strokeStyle="rgba(0,0,0,0)",g=1),i.lineWidth=g,i.beginPath(),i.arc(h.width/2,h.height/2,b,0,2*Math.PI,!0),i.stroke(),i.closePath(),null!=e&&(i.save(),i.clip(),f&&"transparent"==e?this._drawUIGrid(i,h.width,h.height):(i.fillStyle=e,i.fillRect(0,0,h.width,h.height)),i.restore())},d.ControlsWidget.prototype._drawUIGrid=function(a,b,c,d){var e,f;for(d||(d=5),f=0;c+d>f;f+=d)for(e=0;c+d>e;e+=d)a.fillStyle=1==(e+f&1)?"#fff":"#ddd",a.fillRect(e,f,d,d)},d.ControlsWidget.prototype.showPanel=function(a){null!=a&&(avpw$(".avpw_controlpanel").each(function(){avpw$(this).hide()}),avpw$("#avpw_controlpanel_"+a).show())},d.ControlsWidget.prototype.save=function(){var a=null,c=!0,f=1e3,g=function(){return{apikey:d.launchData.apiKey,timestamp:d.launchData.timestamp,signature:d.launchData.signature,salt:d.launchData.salt,encryptionmethod:d.launchData.encryptionMethod}},h=function(a,b,c){var e=d.controlsWidgetInstance;if(e.layoutNotify(d.launchData.openType,"enableControls",[!0]),e.paintWidget.showWaitThrobber(!1),a){var f=avpw$(d.util.getImageElem(e.paintImgIdElem));f.avpw_prevURL=a,d.controlsWidget_onImageSaved(a,b)}else d.errorNotify("ERROR_SAVING",[d.build.imgrecvServer,c]),d.controlsWidgetInstance.saving=!1},i=function(a,b){var c=d.controlsWidgetInstance;if(c.layoutNotify(d.launchData.openType,"enableControls",[!0]),c.paintWidget.showWaitThrobber(!1),a){var e=avpw$(d.util.getImageElem(c.paintImgIdElem));e.avpw_prevURL=a,d.controlsWidget_onHiResImageSaved(a)}else d.errorNotify("ERROR_SAVING",[d.build.asyncImgrecvBase,b]),d.controlsWidgetInstance.saving=!1},j=function(a){var b,c,d,e,f="";if("string"==typeof a)b=a.split("---FEATHER-POSTMESSAGE---"),c=b[0],d=b[1];else if(e=avpw$(a).find("error"),e.length>0)f=e.text();else{var g=avpw$(a).find("url");g&&(c=g.text(),c=c.replace(/^\s+|\s+$/g,""));var i=avpw$(a).find("hiresurl");i&&(d=i.text(),d=d.replace(/^\s+|\s+$/g,""))}h(c,d,f)},k=function(){var a=this;a.paintWidget.exportImage(null,function(b){var c,e,f=b.indexOf(";",0),h=b.indexOf(",",f);c=b.slice(5,f),e=b.slice(h+1),b="",d.controlsWidgetInstance.serverMessaging.sendMessage({id:"avpw_save_form",action:d.build.imgrecvServer,method:"POST",announcer:d.build.featherTargetAnnounce,origin:d.build.imgrecvBase,keyValues:d.util.extend(g(),{file:e,postdata:d.launchData.postData,posturl:d.launchData.postUrl,sessionid:d.usageTracker.getUUID(),actionlist:a.paintWidget.actions.exportJSON(!0),origurl:a.origURL,hiresurl:d.launchData.hiresUrl,contenttype:d.launchData.fileFormat,jpgquality:d.launchData.jpgQuality,debug:d.launchData.debug,asyncsave:d.launchData.asyncSave,usecustomfileexpiration:d.launchData.useCustomFileExpiration,encodedas:"base64text"}),callback:j})})},l=function(){var e=d.util.extend(g(),{actionlist:this.paintWidget.actions.exportJSON(!0),origurl:d.launchData.hiresUrl,fileformat:d.launchData.fileFormat,notificationmethod:"GET",backgroundcolor:"0xffffffff",jpgquality:d.launchData.jpgQuality}),h=function(d){!d||d&&"JobFailed"===d.JobStatusCode?(i(null),b.clearInterval(a)):d&&"JobCompleted"===d.JobStatusCode&&(b.clearInterval(a),i(d.JobStatus)),c=!0},j=function(e){var j;e&&e.JobId?(j=e.JobId,a=b.setInterval(function(){c&&d.controlsWidgetInstance.serverMessaging.sendMessage({id:"avpw_save_form",action:d.build.asyncImgrecvGetJobStatus,method:"POST",dataType:"json",announcer:d.build.asyncFeatherTargetAnnounce,origin:d.build.asyncImgrecvBase,keyValues:d.util.extend(g(),{jobid:j}),callback:h}),c=!1},f)):i(null)};d.controlsWidgetInstance.serverMessaging.sendMessage({id:"avpw_save_form",action:d.build.asyncImgrecvCreateJob,method:"POST",dataType:"json",announcer:d.build.asyncFeatherTargetAnnounce,origin:d.build.asyncImgrecvBase,keyValues:e,callback:j})},m=function(a,b,c){var e=this;e.paintWidget.exportImage(c,function(c){var e=d.controlsWidgetInstance;e.saving=!1,e.layoutNotify(d.launchData.openType,"enableControls",[!0]),e.paintWidget.showWaitThrobber(!1),a&&"function"==typeof a&&(b?b=a(c)===!1?!1:!0:a(c)),b&&d.util.nextFrame(function(){d.controlsWidget_onImageSaved(e.origURL)})})},n=function(a,b,c,e){var f=!d.featherUseFlash;f&&this.layoutNotify(d.launchData.openType,"disableControls"),this.paintWidget.showWaitThrobber(f,function(){switch(a){case"saveHiRes":l.call(g);break;case"getImageData":m.call(g,b,c,e);break;default:k.call(g)}});var g=this;
return!1};return function(a,b,c,f){return d.controlsWidgetInstance.loaderPhase<2?!1:this.saving?!1:(e.trigger("tool:commit"),e.trigger("tool:close"),this.saving=!0,d.prevActionList=this.paintWidget.actions.exportJSON(!0),d.launchData.postData&&"string"!=typeof d.launchData.postData&&(d.launchData.postData=d.JSON.stringify(d.launchData.postData)),n.apply(this,[a,b,c,f]))}}(),d.ControlsWidget.prototype.onSaveButtonClicked=function(){if(e.trigger("usage:submit","saveclicked"),"function"==typeof d.launchData.onSaveButtonClicked){var a=d.launchData.onSaveButtonClicked.apply(d.launchData,[d.util.getImageId(d.controlsWidgetInstance.paintImgIdElem)]);if(a===!1)return!1}return d.controlsWidgetInstance.save()},d.ControlsWidget.prototype.showAreYouSure=function(){this.messager.show("avpw_aviary_quitareyousure",!0)},d.ControlsWidget.prototype.cancel=function(){this.quitCount++;var a=this.quitCount>0&&this.paintWidget&&this.paintWidget.dirty;if("function"==typeof d.launchData.onCloseButtonClicked){var b=d.launchData.onCloseButtonClicked.apply(d.launchData,[a]);if(b===!1)return!1}return a?this.showAreYouSure():d.paintWidgetCloser(),!1},d.ControlsWidget.prototype.getScaledDims=function(a,b){return d.util.getScaledDims(a,b,this.maxWidth,this.maxHeight)},d.TransformStyle=function(a){var b=this,c=a||"";return b.set=function(a){if(c)for(var b in a){var d=b+"\\([^\\)]*",e=new RegExp(d),f=!1,g=function(){return f=!0,b+"("+a[b]};c=c.replace(e,g),f||(c+=" "+b+"("+a[b]+")")}else for(var b in a)c+=" "+b+"("+a[b]+")"},b.serialize=function(){return c},b},a}(this,"undefined"!=typeof window?window:{},"undefined"!=typeof document?document:{}),function(a){a.errorNotify=function(b,c){var d={BAD_IMAGE:{code:1,message:"There was a problem loading your image provided to the `image` config key. Either it's not actually an image file or it doesn't really exist."},UNSUPPORTED:{code:2,message:"It looks like you're using a browser that doesn't support the HTML canvas element (and also doesn't have Flash installed either). Please try accessing this page through a modern browser like Chrome, Firefox, Safari, or Internet Explorer (version 9 or higher). Your internets will thank you."},BAD_URL:{code:3,message:"There was a problem loading your image provided by URI to the `url` config key. It is not reachable by the public (and our service at "+(a.featherUseFlash?a.build.proxyServer:a.build.imgrecvBase)+")"},UNSUPPORTED_TOOL:{code:4,message:"So sorry, but this tool is not available because it is not part of the set chosen with the `tools` config key. It's alternatively possible that your browser does not support this specific tool."},IMAGE_NOT_CLEAN:{code:5,message:"Uh oh! We can't edit this image because the editor wasn't set up correctly to load external files via their address. You must either provide images from the same domain as the web page with the editor OR pass the external image address via the `url` config key in order for Aviary to be able to get permission from the browser to open it for editing. Sorry for the inconvenience!"},UNSUPPORTED_FONT:{code:6,message:"So sorry, but this font looks to be unsupported by your browser or platform"},ERROR_SAVING:{code:7,message:"There was a problem saving your photo. Please try again."},NO_APIKEY:{code:8,message:"apiKey is required and not provided. See http://www.aviary.com/web-documentation#constructor-config-apikey."},ERROR_AUTHENTICATING:{code:9,message:"There was a problem retrieving access to content from our server. Please ensure all authentication keys are present or do not attempt premium partner authentication."}},e=function(){},f=d[b],g=f.message;return"function"==typeof a.launchData.onError&&(f.args=c,g=a.launchData.onError(f)||g),g&&e(g),g}}(window.AV||(window.AV={}),window,document),function(a,b,c){a.AV=a.AV||{};var d=a.AV,e=d.Events;a.Aviary=d,d.feather_loaded=!1,d.feather_loading=!1,d.build=d.build||{version:"",imgrecvServer:"imgrecvserver",flashGatewayServer:"",imgrecvBase:"",inAppPurchaseFrameURL:"",imgtrackServer:"imgtrackserver",filterServer:"",jsonp_imgserver:"",featherTargetAnnounce:"feather_target_announce_v3.html",proxyServer:"",feather_baseURL:"",feather_stickerURL:"",googleTracker:"",MINIMUM_FLASH_PLAYER_VERSION:"10.2.0"},d.defaultTools=["enhance","effects","frames","overlay","crop","resize","orientation","focus","brightness","contrast","saturation","warmth","sharpness","colorsplash","drawing","textwithfont","redeye","whiten","blemish"],d.flashSupportedTools=["enhance","effects","overlay","crop","resize","orientation","brightness","contrast","saturation","sharpness","drawing","text","redeye","blemish"];var f={};return f.image=null,f.apiKey=void 0,f.apiVersion=1,f.appendTo=null,f.language="en",f.minimumStyling=!1,f.maxSize=800,f.noCloseButton=!1,f.launchDelay=300,f.closeDelay=300,f.tools=void 0,f.initTool="",f.cropPresets=["Original","Custom",["Square","1:1"],"3:2","3:5","4:3","4:5","4:6","5:7","8:10","16:9"],f.cropPresetDefault="Custom",f.cropPresetsStrict=!1,f.url=null,f.postUrl=void 0,f.postData=null,f.fileFormat="",f.jpgQuality=100,f.displayImageSize=!1,f.hiresMaxSize=1e4,f.hiresWidth=null,f.hiresHeight=null,f.onLoad=void 0,f.onReady=void 0,f.onSaveButtonClicked=void 0,f.onSave=void 0,f.onSaveHiRes=void 0,f.onClose=void 0,f.onError=void 0,f.signature=null,f.timestamp=null,f.hiresUrl=void 0,f.useCustomFileExpiration=!1,f.allowInAppPurchase=!1,f.forceFlash=!1,f.forceSupport=!1,f.poweredByURL="http://www.aviary.com",f.giveFeedbackURL="http://www.aviary.com/feature-requests",f.getWidgetURL="http://www.aviary.com",f.debug=!1,f.asyncSave=!0,d.baseConfig=f,function(a){var b=function(a){return{language:a.Feather_Language,forceFlash:a.Feather_ForceFlash,forceSupport:a.AV_Feather_ForceSupport,onLoad:a.Feather_OnLoad,onReady:a.Feather_OnLaunchComplete,onClose:a.Feather_OnClose,onSave:a.Feather_OnSave,noCloseButton:a.Feather_NoCloseButton,maxSize:a.Feather_MaxSize||a.Feather_MaxDisplaySize,tools:a.Feather_EditOptions,cropPresets:a.Feather_CropSizes,resizePresets:a.Feather_ResizeSizes,apiKey:a.Feather_APIKey,hiresUrl:a.Feather_HiResURL,postUrl:a.Feather_PostURL,fileFormat:a.Feather_FileFormat||a.Feather_ContentType,jpgQuality:a.Feather_FileQuality,signature:a.Feather_Signature,timestamp:a.Feather_Timestamp}};if(d.baseConfig=d.util.extend(d.baseConfig,b(a)),"https:"==a.location.protocol||"chrome-extension:"==a.location.protocol){var c,e;for(var f in d.build)e=f.split("_SSL"),2===e.length&&d.build[f]&&(c=e[0],d.build[c]=d.build[f])}(a.Feather_Theme||a.Feather_OpenType||a.Feather_APIKey)&&d.util.nextFrame(function(){var c=new d.Feather(d.baseConfig);a.aviaryeditor=function(e,f,g,h){d.launchData=d.util.extend(d.baseConfig,b(a));var i=d.util.extend(d.launchData,{image:e,url:f,postData:g,appendTo:h});c.launch(i)},a.aviaryeditor_close=c.close,a.aviaryeditor_relaunch=c.relaunch,a.aviaryeditor_activatetool=c.activateTool,a.aviarynewimage=c.replaceImage})}(b),d.getLocalizedString=function(a){try{var b=d.lang[d.launchData.language][a];return void 0===b&&(b=a),b}catch(c){}return a},Function.prototype.AV_bindInst=function(a){var b=this;return function(){return b.apply(a,arguments)}},d.injectControls=function(){var a,b;if("popup"==d.launchData.openType?(a="",b=d.template[d.launchData.layout].saveBlock()):(a=d.template[d.launchData.layout].saveBlock(),b=""),d.criticalLayoutStyles&&!d.feather_loaded){var e=c.createElement("style");e.type="text/css";var f=c.createTextNode(d.criticalLayoutStyles);e.styleSheet?e.styleSheet.cssText=f.nodeValue:e.appendChild(f);var g=c.getElementsByTagName("head")[0];g.appendChild(e)}var h=d.template[d.launchData.layout].controls({internalSaveBlock:a,externalSaveBlock:b}),i=c.createElement("div");i.id="avpw_holder";var j="";d.featherUseFlash&&(j="avpw_flash "),d.msie&&(j+="avpw_ie"+d.msie),j&&(i.className=j);var k=c.getElementsByTagName("body");k&&(k=k[0]),k||(k=c.documentElement),k.appendChild(i),i.innerHTML=h},d.Feather=function(a){var b=this,f=function(){d.injectControls(),d.util.nextFrame(d.loadStageFinal)},g=function(){"undefined"!=typeof avpw$?avpw$(c).ready(f):f()};a&&(a.openType="aviary",a.layout="desktop"),a=a||{},d.launchData=d.util.extend(d.baseConfig,a),function(){function a(a){var b=d.build.feather_baseURL+"css/"+a;d.util.loadFile(b+".css","css")}var b,c;d.featherUseFlash=!d.featherHtmlOk()&&d.featherFlashOk(),d.launchData.language=d.launchData.language.toLowerCase(),d.feather_loaded||d.feather_loading||(d.feather_loading=!0,b=d.launchData.language||"en",c="js/feathercontrols_desktop",c+=d.validLanguages&&d.validLanguages[b]?"_"+b+".js":"_en.js",a(d.launchData.minimumStyling?"feather_core":"feather_theme_aviary"),d.util.loadFile(d.build.feather_baseURL+"images/aviary_atlas.png","img"),d.build.bundled?g():d.util.loadFile(d.build.feather_baseURL+c,"js",g))}();var h=function(){if(d.paintWidgetInstance)return!1;var a=d.util.getImageElem(d.launchData.image);d.paintWidgetLauncher(a,d.launchData.url)};return b.launch=function(a){if(!d.feather_loaded)return!1;var e=c.getElementById("avpw_holder");if(e||d.injectControls(),d.paintWidgetInstance){if(e)return!1;b.close(!0)}if(a&&a.language&&delete a.language,d.launchData=a?d.util.extend(d.launchData,a):d.launchData,!d.launchData.image)return d.errorNotify("BAD_IMAGE"),!1;if(d.launchData.image=d.util.getImageElem(d.launchData.image),d.featherUseFlash)h();else{if(!d.featherSupported())return d.errorNotify("UNSUPPORTED")&&(d.controlsWidgetInstance=new d.ControlsWidget,d.controlsWidgetInstance.layoutNotify(d.launchData.openType,"placeControls",[2===d.util.getApiVersion(d.launchData)?d.launchData.appendTo:void 0]),d.controlsWidgetInstance.bindControls(),c.getElementById("avpw_controls").style.display="block",d.controlsWidgetInstance.messager.show("avpw_aviary_unsupported",!0)),!0;d.util.nextFrame(h)}return!0},b.showWaitIndicator=function(){return d.controlsWidgetInstance&&d.controlsWidgetInstance.showWaitThrobber?(d.controlsWidgetInstance.showWaitThrobber(!0),!0):!1},b.hideWaitIndicator=function(){return d.controlsWidgetInstance&&d.controlsWidgetInstance.showWaitThrobber?(d.controlsWidgetInstance.showWaitThrobber(!1),!0):!1},b.getImageDimensions=function(){var a=null;return d.paintWidgetInstance&&(a=d.paintWidgetInstance.getScaledSize(),d.launchData.hiresWidth&&d.launchData.hiresHeight||(delete a.hiresWidth,delete a.hiresHeight)),a},b.save=function(){return d.paintWidgetInstance?d.controlsWidgetInstance.save():!1},b.saveHiRes=function(){return d.paintWidgetInstance?d.controlsWidgetInstance.save("saveHiRes"):!1},b.getImageData=function(a,b,c){return d.paintWidgetInstance?d.controlsWidgetInstance.save("getImageData",a,b,c):!1},b.close=function(a){return d.paintWidgetInstance?void d.paintWidgetCloser(a):!1},b.relaunch=function(){return e.trigger("usage:interact","api","relaunch"),d.isRelaunched=!0,d.launchData?void b.launch(d.launchData):!1},b.activateTool=function(a){e.trigger("tool:open",a,d.controlsWidgetInstance)},b.replaceImage=function(a){return e.trigger("usage:interact","api","replaceImage"),d.launchData?(b.close(!0),void d.util.nextFrame(function(){d.launchData.url=a,b.launch(d.launchData)})):!1},b.updateConfig=function(a,b){if(!d.launchData)return!1;if(a&&"object"==typeof a)for(var c in a)a.hasOwnProperty(c)&&(d.launchData[c]=a[c]);else{if(!a||"string"!=typeof a)return!1;d.launchData[a]=b}},b.getIsDirty=function(){return d.paintWidgetInstance?d.paintWidgetInstance.dirty:!1},b.getActionList=function(){return d.paintWidgetInstance?(e.trigger("tool:commit"),d.paintWidgetInstance.actions.exportJSON(!0)):void 0},b.disableControls=function(){d.controlsWidgetInstance.layoutNotify(d.launchData.openType,"disableControls")},b.enableControls=function(){d.controlsWidgetInstance.layoutNotify(d.launchData.openType,"enableControls")},b.on=function(a,b){e&&a&&b&&"function"==typeof b&&e.on(a,b)},b.off=function(a,b){e&&a&&b&&"function"==typeof b&&e.off(a,b)},b},d.loadStageFinal=function(){d.feather_loaded=!0,"function"==typeof d.launchData.onLoad&&d.launchData.onLoad()},d.featherSupported=function(){return d.featherHtmlOk()||d.featherFlashOk()||d.launchData.forceSupport},d.featherFlashOk=function(){return d.launchData.forceFlash?!0:avpw_swfobject&&avpw_swfobject.hasFlashPlayerVersion(d.build.MINIMUM_FLASH_PLAYER_VERSION)},d.featherHtmlOk=function(){if(d.launchData.forceFlash)return!1;var a=!!c.createElement("canvas").getContext,e="function"==typeof b.postMessage;return a&&e},d.getFlashMovie=function(a){var d=b[a]||c[a];return d},d.msie=function(){for(var a,b=3,d=c.createElement("div"),e=d.getElementsByTagName("i");d.innerHTML="<!--[if gt IE "+ ++b+"]><i></i><![endif]-->",e[0];);return b>4?b:a}(),d.firefox=function(){var a;return"Gecko"===b.navigator.product&&(a=navigator.userAgent.split("Firefox/")[1],a=parseInt(a,10)),a}(),d.PAGE_WIDTH=360,d.setPageWidth=function(a){d.PAGE_WIDTH=a},a}(this,"undefined"!=typeof window?window:{},"undefined"!=typeof document?document:{}),function(a,b,c){a.support=function(a){var b,d=a.navigator.userAgent,e=a.screen.width,f=(a.screen.height,{0:/Android/i,1:/webOS/i,2:/iPhone/i,3:/iPod/i,4:/BlackBerry/i,5:/iPad/i}),g=0,h=0,i=0,j=0;for(var k in f)d.match(f[k])&&(g=1,b=parseInt(k));if(d.match(/AppleWebKit/i)&&(h=1),0===b&&(i=1),1===i){var l=d.match(/Android [0-9].[0-9]/).toString();l&&(j=parseFloat(l.split("Android ")[1]))}var m={};return m.isAppleWebkit=function(){return 1===h},m.isMobileWebkit=function(){return 1===h&&e&&(480>=e||j>0&&2.3>=j)},m.isIPhoneOrIPod=function(){return 2===b||3===b},m.isAndroid=function(){return 1===i},m.getAndroidVersion=function(){return j},m.getVendorProperty=function(){var a={},b=function(a,b){var c,d,e=["webkit","ms","Moz","O"],f=a.style;if(void 0!==f[b])return b;for(b=b.charAt(0).toUpperCase()+b.slice(1),d=0;d<e.length;d++)if(c=e[d]+b,void 0!==f[c])return c};return function(d){return a[d]||(a[d]=b(c.createElement("div"),d))}}(),m}(b)}(window.AV||(window.AV={}),window,document);