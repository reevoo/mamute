!function(){var a=function(){var a={},b=function(b,c,d){for(var e=b.split("."),f=0;f<e.length-1;f++)d[e[f]]||(d[e[f]]={}),d=d[e[f]];d[e[f]]="function"==typeof c?c.isClass?c:function(){return c.apply(a,arguments)}:c},c=function(c,d,e){b(c,d,a),e&&b(c,d,window.filepicker)},d=function(b,d,e){"function"==typeof b&&(e=d,d=b,b=""),b&&(b+=".");var f=d.call(a);for(var g in f)c(b+g,f[g],e)},e=function(b){b.apply(a,arguments)};return{extend:d,internal:e}}();if(window.filepicker)for(attr in a)window.filepicker[attr]=a[attr];else window.filepicker=a}(),filepicker.extend("ajax",function(){var a=this,b=function(a,b){b.method="GET",f(a,b)},c=function(b,c){c.method="POST",b+=(b.indexOf("?")>=0?"&":"?")+"_cacheBust="+a.util.getId(),f(b,c)},d=function(b,c){var e=[];for(var f in b){var g=b[f];c&&(f=c+"["+f+"]");var h;switch(a.util.typeOf(g)){case"object":h=d(g,f);break;case"array":for(var i={},j=0;j<g.length;j++)i[j]=g[j];h=d(i,f);break;default:h=f+"="+encodeURIComponent(g)}null!==g&&e.push(h)}return e.join("&")},e=function(){try{return new window.XMLHttpRequest}catch(a){try{return new window.ActiveXObject("Msxml2.XMLHTTP")}catch(a){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(a){return null}}}},f=function(b,c){b=b||"";var f=c.method?c.method.toUpperCase():"POST",h=c.success||function(){},i=c.error||function(){},j=void 0===c.async?!0:c.async,k=c.data||null,l=void 0===c.processData?!0:c.processData,m=c.headers||{},n=a.util.parseUrl(b),o=window.location.protocol+"//"+window.location.host,p=o!==n.origin,q=!1;k&&l&&(k=d(c.data));var r;if(c.xhr)r=c.xhr;else if(r=e(),!r)return c.error("Ajax not allowed"),r;if(p&&window.XDomainRequest&&!("withCredentials"in r))return g(b,c);c.progress&&r.upload&&r.upload.addEventListener("progress",function(a){a.lengthComputable&&c.progress(Math.round(95*a.loaded/a.total))},!1);var s=function(){if(4==r.readyState&&!q)if(c.progress&&c.progress(100),r.status>=200&&r.status<300){var b=r.responseText;if(c.json)try{b=a.json.decode(b)}catch(d){return void t.call(r,"Invalid json: "+b)}h(b,r.status,r),q=!0}else t.call(r,r.responseText),q=!0};r.onreadystatechange=s;var t=function(a){return q?void 0:(c.progress&&c.progress(100),q=!0,400==this.status?void i("bad_params",this.status,this):403==this.status?void i("not_authorized",this.status,this):404==this.status?void i("not_found",this.status,this):p?4==this.readyState&&0===this.status?void i("CORS_not_allowed",this.status,this):void i("CORS_error",this.status,this):void i(a,this.status,this))};r.onerror=t,k&&"GET"==f&&(b+=(-1!=b.indexOf("?")?"&":"?")+k,k=null),r.open(f,b,j),c.json?r.setRequestHeader("Accept","application/json, text/javascript"):r.setRequestHeader("Accept","text/javascript, text/html, application/xml, text/xml, */*");var u=m["Content-Type"]||m["content-type"];if(k&&l&&("POST"==f||"PUT"==f)&&void 0==u&&r.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=utf-8"),m)for(var v in m)r.setRequestHeader(v,m[v]);return r.send(k),r},g=function(b,c){if(!window.XDomainRequest)return null;var e=c.method?c.method.toUpperCase():"POST",f=c.success||function(){},g=c.error||function(){},h=c.data||{};if("http:"==window.location.protocol?b=b.replace("https:","http:"):"https:"==window.location.protocol&&(b=b.replace("http:","https:")),c.async)throw new a.FilepickerException("Asyncronous Cross-domain requests are not supported");"GET"!=e&&"POST"!=e&&(h._method=e,e="POST"),c.processData!==!1&&(h=h?d(h):null),h&&"GET"==e&&(b+=(b.indexOf("?")>=0?"&":"?")+h,h=null),b+=(b.indexOf("?")>=0?"&":"?")+"_xdr=true&_cacheBust="+a.util.getId();var i=new window.XDomainRequest;return i.onload=function(){var b=i.responseText;if(c.progress&&c.progress(100),c.json)try{b=a.json.decode(b)}catch(d){return void g("Invalid json: "+b,200,i)}f(b,200,i)},i.onerror=function(){c.progress&&c.progress(100),g(i.responseText||"CORS_error",this.status||500,this)},i.onprogress=function(){},i.ontimeout=function(){},i.timeout=3e4,i.open(e,b,!0),i.send(h),i};return{get:b,post:c,request:f}}),filepicker.extend("base64",function(){_keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var a=function(a,b){b=b||void 0===b;var d,e,f,g,h,i,j,k="",l=0;for(b&&(a=c(a));l<a.length;)d=a.charCodeAt(l),e=a.charCodeAt(l+1),f=a.charCodeAt(l+2),l+=3,g=d>>2,h=(3&d)<<4|e>>4,i=(15&e)<<2|f>>6,j=63&f,isNaN(e)?i=j=64:isNaN(f)&&(j=64),k=k+_keyStr.charAt(g)+_keyStr.charAt(h)+_keyStr.charAt(i)+_keyStr.charAt(j);return k},b=function(a,b){b=b||void 0===b;var c,e,f,g,h,i,j,k="",l=0;for(a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");l<a.length;)g=_keyStr.indexOf(a.charAt(l)),h=_keyStr.indexOf(a.charAt(l+1)),i=_keyStr.indexOf(a.charAt(l+2)),j=_keyStr.indexOf(a.charAt(l+3)),l+=4,c=g<<2|h>>4,e=(15&h)<<4|i>>2,f=(3&i)<<6|j,k+=String.fromCharCode(c),64!=i&&(k+=String.fromCharCode(e)),64!=j&&(k+=String.fromCharCode(f));return b&&(k=d(k)),k},c=function(a){a=a.replace(/\r\n/g,"\n");for(var b="",c=0;c<a.length;c++){var d=a.charCodeAt(c);128>d?b+=String.fromCharCode(d):d>127&&2048>d?(b+=String.fromCharCode(d>>6|192),b+=String.fromCharCode(63&d|128)):(b+=String.fromCharCode(d>>12|224),b+=String.fromCharCode(d>>6&63|128),b+=String.fromCharCode(63&d|128))}return b},d=function(a){for(var b="",c=0,d=c1=c2=0;c<a.length;)d=a.charCodeAt(c),128>d?(b+=String.fromCharCode(d),c++):d>191&&224>d?(c2=a.charCodeAt(c+1),b+=String.fromCharCode((31&d)<<6|63&c2),c+=2):(c2=a.charCodeAt(c+1),c3=a.charCodeAt(c+2),b+=String.fromCharCode((15&d)<<12|(63&c2)<<6|63&c3),c+=3);return b};return{encode:a,decode:b}},!0),filepicker.extend("browser",function(){var a=function(){return!!(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i))},b=function(){return!!navigator.userAgent.match(/Android/i)},c=function(){return!!navigator.userAgent.match(/MSIE 7\.0/i)};return{isIOS:a,isAndroid:b,isIE7:c}}),filepicker.extend("comm",function(){var a=this,b="filepicker_comm_iframe",c=function(){if(void 0===window.frames[b]){f();var c;c=document.createElement("iframe"),c.id=c.name=b,c.src=a.urls.COMM,c.style.display="none",document.body.appendChild(c)}},d=function(b){if(b.origin==a.urls.BASE){var c=a.json.parse(b.data);a.handlers.run(c)}},e=!1,f=function(){if(!e)if(e=!0,window.addEventListener)window.addEventListener("message",d,!1);else{if(!window.attachEvent)throw new a.FilepickerException("Unsupported browser");window.attachEvent("onmessage",d)}},g=function(){if(window.removeEventListener)window.removeEventListener("message",d,!1);else{if(!window.attachEvent)throw new a.FilepickerException("Unsupported browser");window.detachEvent("onmessage",d)}if(e){e=!1;for(var c=document.getElementsByName(b),f=0;f<c.length;f++)c[f].parentNode.removeChild(c[f]);try{delete window.frames[b]}catch(g){}}};return{openChannel:c,closeChannel:g}}),filepicker.extend("comm_fallback",function(){var a,b=this,c="filepicker_comm_iframe",d="host_comm_iframe",e="",f=200,g=function(){h()},h=function(){if(void 0===window.frames[d]){var a;a=document.createElement("iframe"),a.id=a.name=d,e=a.src=b.urls.constructHostCommFallback(),a.style.display="none";var c=function(){e=a.contentWindow.location.href,i()};a.attachEvent?a.attachEvent("onload",c):a.onload=c,document.body.appendChild(a)}},i=function(){if(void 0===window.frames[c]){var a;a=document.createElement("iframe"),a.id=a.name=c,a.src=b.urls.FP_COMM_FALLBACK+"?host_url="+encodeURIComponent(e),a.style.display="none",document.body.appendChild(a)}n()},j=!1,k=void 0,l="",m=function(){var a=window.frames[c];if(a){var e=a.frames[d];if(e){var f=e.location.hash;if(f&&"#"==f.charAt(0)&&(f=f.substr(1)),f!==l&&(l=f)){var g;try{g=b.json.parse(f)}catch(h){}g&&b.handlers.run(g)}}}},n=function(){j||(j=!0,k=window.setInterval(m,f))},o=function(){if(window.clearInterval(k),j){j=!1;for(var a=document.getElementsByName(c),b=0;b<a.length;b++)a[b].parentNode.removeChild(a[b]);try{delete window.frames[c]}catch(e){}for(a=document.getElementsByName(d),b=0;b<a.length;b++)a[b].parentNode.removeChild(a[b]);try{delete window.frames[d]}catch(e){}}},p=!("postMessage"in window),q=function(){a=b.comm,b.comm={openChannel:g,closeChannel:o}};return p&&q(),{openChannel:g,closeChannel:o,isEnabled:p}}),filepicker.extend("conversions",function(){var a=this,b={width:"number",height:"number",fit:"string",format:"string",watermark:"string",watermark_size:"number",watermark_position:"string",align:"string",crop:"string or array",quality:"number",text:"string",text_font:"string",text_size:"number",text_color:"string",text_align:"string",text_padding:"number",policy:"string",signature:"string",storeLocation:"string",storePath:"string",storeAccess:"string",rotate:"string or number"},c=function(c){var d;for(var e in c){d=!1;for(var f in b)if(e==f&&(d=!0,-1===b[f].indexOf(a.util.typeOf(c[e]))))throw new a.FilepickerException("Conversion parameter "+e+" is not the right type: "+c[e]+". Should be a "+b[f]);if(!d)throw new a.FilepickerException("Conversion parameter "+e+" is not a valid parameter.")}},d=function(b,d,e,f,g){c(d),d.crop&&a.util.isArray(d.crop)&&(d.crop=d.crop.join(",")),a.ajax.post(b+"/convert",{data:d,json:!0,success:function(b){e(a.util.standardizeFPFile(b))},error:function(b){f("not_found"==b?new a.errors.FPError(141):"bad_params"==b?new a.errors.FPError(142):"not_authorized"==b?new a.errors.FPError(403):new a.errors.FPError(143))},progress:g})};return{convert:d}}),filepicker.extend("cookies",function(){var a=this,b=function(b){var c=function(c){"ThirdPartyCookies"===c.type&&(a.cookies.THIRD_PARTY_COOKIES=!!c.payload,b&&"function"==typeof b&&b(!!c.payload))};return c},c=function(c){var d=b(c);a.handlers.attach("cookies",d),a.comm.openChannel()};return{checkThirdParty:c}}),filepicker.extend("dragdrop",function(){var a=this,b=function(){return(!!window.FileReader||navigator.userAgent.indexOf("Safari")>=0)&&"draggable"in document.createElement("span")},c=function(c,d){var e="No DOM element found to create drop pane";if(!c)throw new a.FilepickerException(e);if(c.jquery){if(0===c.length)throw new a.FilepickerException(e);c=c[0]}if(!b())return a.util.console.error("Your browser doesn't support drag-drop functionality"),!1;d=d||{};var f=d.dragEnter||function(){},g=d.dragLeave||function(){},h=d.onStart||function(){},i=d.onSuccess||function(){},j=d.onError||function(){},k=d.onProgress||function(){},l=d.mimetypes;l||(l=d.mimetype?[d.mimetype]:["*/*"]),"string"==a.util.typeOf(l)&&(l=l.split(","));var m=d.extensions;m||d.extension&&(m=[d.extensions]),"string"==a.util.typeOf(m)&&(m=m.split(","));var n={location:d.location,path:d.path,access:d.access,policy:d.policy,signature:d.signature};c.addEventListener("dragenter",function(a){return f(),a.stopPropagation(),a.preventDefault(),!1},!1),c.addEventListener("dragleave",function(a){return g(),a.stopPropagation(),a.preventDefault(),!1},!1),c.addEventListener("dragover",function(a){return a.preventDefault(),!1},!1),c.addEventListener("drop",function(b){b.stopPropagation(),b.preventDefault();var c,d,e;if(b.dataTransfer.items)for(d=b.dataTransfer.items,c=0;c<d.length;c++)if(e=d[c]&&d[c].webkitGetAsEntry?d[c].webkitGetAsEntry():void 0,e&&e.isDirectory)return void j("WrongType","Uploading a folder is not allowed");var f=b.dataTransfer.files,g=f.length;if(u(f))for(h(f),c=0;c<f.length;c++)a.store(f[c],n,q(c,g),r,s(c,g))});var o={},p=[],q=function(a,b){return function(c){d.multiple?(p.push(c),p.length==b?(i(p),p=[]):(o[a]=100,t(b))):i([c])}},r=function(a){j("UploadError",a.toString())},s=function(a,b){return function(c){o[a]=c,t(b)}},t=function(a){var b=0;for(var c in o)b+=o[c];var d=b/a;k(d)},u=function(b){if(b.length>0){if(b.length>1&&!d.multiple)return j("TooManyFiles","Only one file at a time"),!1;for(var c,e,f,g=0;g<b.length;g++){c=!1,e=b[g],f=e.name||e.fileName||'"Unknown file"';for(var h=0;h<l.length;h++){var i=a.mimetypes.getMimetype(e);c=c||a.mimetypes.matchesMimetype(i,l[h])}if(!c)return j("WrongType",f+" isn't the right type of file"),!1;if(m){for(c=!1,h=0;h<m.length;h++)c=c||a.util.endsWith(f,m[h]);if(!c)return j("WrongType",f+" isn't the right type of file"),!1}if(e.size&&d.maxSize&&e.size>d.maxSize)return j("WrongSize",f+" is too large ("+e.size+" Bytes)"),!1}return!0}return j("NoFilesFound","No files uploaded"),!1};return!0};return{enabled:b,makeDropPane:c}}),filepicker.extend("errors",function(){var a=this,b=function(a){if(this===window)return new b(a);if(this.code=a,filepicker.debug){var c=filepicker.error_map[this.code];this.message=c.message,this.moreInfo=c.moreInfo,this.toString=function(){return"FPError "+this.code+": "+this.message+". For help, see "+this.moreInfo}}else this.toString=function(){return"FPError "+this.code+". Include filepicker_debug.js for more info"};return this};b.isClass=!0;var c=function(b){filepicker.debug&&a.util.console.error(b.toString())};return{FPError:b,handleError:c}},!0),filepicker.extend("exporter",function(){var a=this,b=function(b){var c=function(c,d,e){b[d]&&!a.util.isArray(b[d])?b[d]=[b[d]]:b[c]?b[d]=[b[c]]:e&&(b[d]=e)};if(b.mimetype&&b.extension)throw a.FilepickerException("Error: Cannot pass in both mimetype and extension parameters to the export function");if(c("service","services"),b.services)for(var d=0;d<b.services.length;d++){var e=(""+b.services[d]).replace(" ",""),f=a.services[e];b.services[d]=void 0===f?e:f}b.openTo&&(b.openTo=a.services[b.openTo]||b.openTo),a.util.setDefault(b,"container","modal")},c=function(b,c){var d=function(d){if("filepickerUrl"===d.type){if(d.error)a.util.console.error(d.error),c(a.errors.FPError(132));else{var e={};e.url=d.payload.url,e.filename=d.payload.data.filename,e.mimetype=d.payload.data.type,e.size=d.payload.data.size,e.isWriteable=!0,b(e)}a.modal.close()}};return d},d=function(e,f,g,h){if(b(f),f.debug)return void setTimeout(function(){g({url:"https://www.filepicker.io/api/file/-nBq2onTSemLBxlcBWn1",filename:"test.png",mimetype:"image/png",size:58979})},1);if(void 0===a.cookies.THIRD_PARTY_COOKIES)return void a.cookies.checkThirdParty(function(){d(e,f,g,h)});var i=a.util.getId(),j=!1,k=function(a){j=!0,g(a)},l=function(a){j=!0,h(a)},m=function(){j||(j=!0,h(a.errors.FPError(131)))};"modal"==f.container&&(f.mobile||a.window.shouldForce())&&(f.container="window"),a.window.open(f.container,a.urls.constructExportUrl(e,f,i),m),a.handlers.attach(i,c(k,l))};return{createExporter:d}}),filepicker.extend("files",function(){var a=this,b=function(b,d,e,f,g){var h=void 0===d.base64encode;h&&(d.base64encode=!0),d.base64encode=d.base64encode!==!1;var i=function(b){h&&(b=a.base64.decode(b,!!d.asText)),e(b)};c.call(this,b,d,i,f,g)},c=function(b,c,d,e,f){c.cache!==!0&&(c._cacheBust=a.util.getId()),a.ajax.get(b,{data:c,headers:{"X-NO-STREAM":!0},success:d,error:function(b){e("CORS_not_allowed"==b?new a.errors.FPError(113):"CORS_error"==b?new a.errors.FPError(114):"not_found"==b?new a.errors.FPError(115):"bad_params"==b?new a.errors.FPError(400):"not_authorized"==b?new a.errors.FPError(403):new a.errors.FPError(118))},progress:f})},d=function(b,c,d,e,f){if(!(window.File&&window.FileReader&&window.FileList&&window.Blob))return f(10),void a.files.storeFile(b,{},function(b){f(50),a.files.readFromFPUrl(b.url,c,d,e,function(a){f(50+a/2)})},e,function(a){f(a/2)});var g=!!c.base64encode,h=!!c.asText,i=new FileReader;i.onprogress=function(a){a.lengthComputable&&f(Math.round(a.loaded/a.total*100))},i.onload=function(b){f(100),d(g?a.base64.encode(b.target.result,h):b.target.result)},i.onerror=function(b){switch(b.target.error.code){case b.target.error.NOT_FOUND_ERR:e(new a.errors.FPError(115));break;case b.target.error.NOT_READABLE_ERR:e(new a.errors.FPError(116));break;case b.target.error.ABORT_ERR:e(new a.errors.FPError(117));break;default:e(new a.errors.FPError(118))}},h||!i.readAsBinaryString?i.readAsText(b):i.readAsBinaryString(b)},e=function(b,c,d,e,f,g){var h=d.mimetype||"text/plain";a.ajax.post(a.urls.constructWriteUrl(b,d),{headers:{"Content-Type":h},data:c,processData:!1,json:!0,success:function(b){e(a.util.standardizeFPFile(b))},error:function(b){f("not_found"==b?new a.errors.FPError(121):"bad_params"==b?new a.errors.FPError(122):"not_authorized"==b?new a.errors.FPError(403):new a.errors.FPError(123))},progress:g})},f=function(b,c,d,e,f,g){var h=function(b){f("not_found"==b?new a.errors.FPError(121):"bad_params"==b?new a.errors.FPError(122):"not_authorized"==b?new a.errors.FPError(403):new a.errors.FPError(123))},i=function(b){e(a.util.standardizeFPFile(b))};k(c,a.urls.constructWriteUrl(b,d),i,h,g)},g=function(b,c,d,e,f,g){var h=function(b){f("not_found"==b?new a.errors.FPError(121):"bad_params"==b?new a.errors.FPError(122):"not_authorized"==b?new a.errors.FPError(403):new a.errors.FPError(123))},i=function(b){e(a.util.standardizeFPFile(b))};d.mimetype=c.type,k(c,a.urls.constructWriteUrl(b,d),i,h,g)},h=function(b,c,d,e,f,g){a.ajax.post(a.urls.constructWriteUrl(b,d),{data:{url:c},json:!0,success:function(b){e(a.util.standardizeFPFile(b))},error:function(b){f("not_found"==b?new a.errors.FPError(121):"bad_params"==b?new a.errors.FPError(122):"not_authorized"==b?new a.errors.FPError(403):new a.errors.FPError(123))},progress:g})},i=function(b,c,d,e,f){if(b.files)return void(0===b.files.length?e(new a.errors.FPError(115)):j(b.files[0],c,d,e,f));a.util.setDefault(c,"storage","S3"),c.filename||(c.filename=b.value.replace("C:\\fakepath\\","")||b.name);var g=b.name;b.name="fileUpload",a.iframeAjax.post(a.urls.constructStoreUrl(c),{data:b,processData:!1,json:!0,success:function(c){b.name=g,d(a.util.standardizeFPFile(c))},error:function(b){e("not_found"==b?new a.errors.FPError(121):"bad_params"==b?new a.errors.FPError(122):"not_authorized"==b?new a.errors.FPError(403):new a.errors.FPError(123))}})},j=function(b,c,d,e,f){a.util.setDefault(c,"storage","S3");var g=function(b){"not_found"==b?e(new a.errors.FPError(121)):"bad_params"==b?e(new a.errors.FPError(122)):"not_authorized"==b?e(new a.errors.FPError(403)):(a.util.console.error(b),e(new a.errors.FPError(123)))},h=function(b){d(a.util.standardizeFPFile(b))};c.filename||(c.filename=b.name||b.fileName),k(b,a.urls.constructStoreUrl(c),h,g,f)},k=function(b,c,d,e,f){b.files&&(b=b.files[0]);var g=!!window.FormData&&!!window.XMLHttpRequest;g?(data=new FormData,data.append("fileUpload",b),a.ajax.post(c,{json:!0,processData:!1,data:data,success:d,error:e,progress:f})):a.iframeAjax.post(c,{data:b,json:!0,success:d,error:e})},l=function(b,c,d,e,f){a.util.setDefault(c,"storage","S3"),a.util.setDefault(c,"mimetype","text/plain"),a.ajax.post(a.urls.constructStoreUrl(c),{headers:{"Content-Type":c.mimetype},data:b,processData:!1,json:!0,success:function(b){d(a.util.standardizeFPFile(b))},error:function(b){e("not_found"==b?new a.errors.FPError(121):"bad_params"==b?new a.errors.FPError(122):"not_authorized"==b?new a.errors.FPError(403):new a.errors.FPError(123))},progress:f})},m=function(b,c,d,e,f){a.util.setDefault(c,"storage","S3"),a.ajax.post(a.urls.constructStoreUrl(c),{data:{url:b},json:!0,success:function(b){d(a.util.standardizeFPFile(b))},error:function(b){e("not_found"==b?new a.errors.FPError(151):"bad_params"==b?new a.errors.FPError(152):"not_authorized"==b?new a.errors.FPError(403):new a.errors.FPError(153))},progress:f})},n=function(b,c,d,e){var f=["uploaded","modified","created"];c.cache!==!0&&(c._cacheBust=a.util.getId()),a.ajax.get(b+"/metadata",{json:!0,data:c,success:function(a){for(var b=0;b<f.length;b++)a[f[b]]&&(a[f[b]]=new Date(a[f[b]]));d(a)},error:function(b){e("not_found"==b?new a.errors.FPError(161):"bad_params"==b?new a.errors.FPError(400):"not_authorized"==b?new a.errors.FPError(403):new a.errors.FPError(162))}})},o=function(b,c,d,e){c.key=a.apikey,a.ajax.post(b+"/remove",{data:c,success:function(){d()},error:function(b){e("not_found"==b?new a.errors.FPError(171):"bad_params"==b?new a.errors.FPError(400):"not_authorized"==b?new a.errors.FPError(403):new a.errors.FPError(172))}})};return{readFromUrl:c,readFromFile:d,readFromFPUrl:b,writeDataToFPUrl:e,writeFileToFPUrl:g,writeFileInputToFPUrl:f,writeUrlToFPUrl:h,storeFileInput:i,storeFile:j,storeUrl:m,storeData:l,stat:n,remove:o}}),filepicker.extend("handlers",function(){var a={},b=function(b,c){return a.hasOwnProperty(b)?a[b].push(c):a[b]=[c],c},c=function(b,c){var d=a[b];if(d)if(c){for(var e=0;e<d.length;e++)if(d[e]===c){d.splice(e,1);break}0===d.length&&delete a[b]}else delete a[b]},d=function(b){var c=b.id;if(a.hasOwnProperty(c)){for(var d=a[c],e=0;e<d.length;e++)d[e](b);return!0}return!1};return{attach:b,detach:c,run:d}}),filepicker.extend("iframeAjax",function(){var a=this,b="ajax_iframe",c=[],d=!1,e=function(a,b){b.method="GET",h(a,b)},f=function(b,c){c.method="POST",b+=(b.indexOf("?")>=0?"&":"?")+"_cacheBust="+a.util.getId(),h(b,c)},g=function(){if(c.length>0){var a=c.shift();h(a.url,a.options)}},h=function(e,f){if(d)return void c.push({url:e,options:f});e+=(e.indexOf("?")>=0?"&":"?")+"_cacheBust="+a.util.getId(),e+="&Content-Type=text%2Fhtml",a.comm.openChannel();var g;try{g=document.createElement('<iframe name="'+b+'">')}catch(h){g=document.createElement("iframe")}g.id=g.name=b,g.style.display="none";var k=function(){d=!1};g.attachEvent?(g.attachEvent("onload",k),g.attachEvent("onerror",k)):g.onerror=g.onload=k,g.id=b,g.name=b,g.style.display="none",g.onerror=g.onload=function(){d=!1},document.body.appendChild(g),a.handlers.attach("upload",i(f));var l=document.createElement("form");l.method=f.method||"GET",l.action=e,l.target=b;var m=f.data;if((a.util.isFileInputElement(m)||a.util.isFile(m))&&(l.encoding=l.enctype="multipart/form-data"),document.body.appendChild(l),a.util.isFile(m)){var n=j(m);if(!n)throw a.FilepickerException("Couldn't find corresponding file input.");m={fileUpload:n}}else if(a.util.isFileInputElement(m)){var o=m;m={},m.fileUpload=o}else m&&a.util.isElement(m)&&"INPUT"==m.tagName?(o=m,m={},m[o.name]=o):f.processData!==!1&&(m={data:m});m.format="iframe";var p={};for(var q in m){var r=m[q];if(a.util.isElement(r)&&"INPUT"==r.tagName)p[q]={par:r.parentNode,sib:r.nextSibling,name:r.name,input:r,focused:r==document.activeElement},r.name=q,l.appendChild(r);else{var s=document.createElement("input");s.name=q,s.value=r,l.appendChild(s)}}d=!0,window.setTimeout(function(){l.submit();for(var a in p){var b=p[a];b.par.insertBefore(b.input,b.sib),b.input.name=b.name,b.focused&&b.input.focus()}l.parentNode.removeChild(l)},1)},i=function(b){var c=b.success||function(){},e=b.error||function(){},f=function(b){if("Upload"===b.type){d=!1;var f=b.payload;f.error?e(f.error):c(f),a.handlers.detach("upload"),g()}};return f},j=function(a){for(var b=document.getElementsByTagName("input"),c=0;c<b.length;c++){var d=b[0];if("file"==d.type&&d.files&&d.files.length)for(var e=0;e<d.files.length;e++)if(d.files[e]===a)return d}return null};return{get:e,post:f,request:h}}),filepicker.extend("json",function(){var a=this,b={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},c=function(a){return b[a]||"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)},d=function(a){return a=a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""),/^[\],:{}\s]*$/.test(a)},e=function(b){if(window.JSON&&window.JSON.stringify)return window.JSON.stringify(b);b&&b.toJSON&&(b=b.toJSON());var d=[];switch(a.util.typeOf(b)){case"string":return'"'+b.replace(/[\x00-\x1f\\"]/g,c)+'"';case"array":for(var f=0;f<b.length;f++)d.push(e(b[f]));return"["+d+"]";case"object":case"hash":var g,h;for(h in b)g=e(b[h]),g&&d.push(e(h)+":"+g),g=null;return"{"+d+"}";case"number":case"boolean":return""+b;case"null":return"null";default:return"null"}return null},f=function(b,c){if(!b||"string"!=a.util.typeOf(b))return null;if(window.JSON&&window.JSON.parse)return window.JSON.parse(b);if(c&&!d(b))throw new Error("JSON could not decode the input; security is enabled and the value is not secure.");return eval("("+b+")")};return{validate:d,encode:e,stringify:e,decode:f,parse:f}}),filepicker.extend(function(){var a=this;a.API_VERSION="v1";var b=function(b){a.apikey=b},c=function(a){return this.text=a,this.toString=function(){return"FilepickerException: "+this.text},this};c.isClass=!0;var d=function(){if(!a.apikey)throw new a.FilepickerException("API Key not found")},e=function(b,c,e){d(),"function"==typeof b&&(e=c,c=b,b={}),b=b||{},c=c||function(){},e=e||a.errors.handleError,a.picker.createPicker(b,c,e,!1)},f=function(b,c,e){d(),"function"==typeof b&&(e=c,c=b,b={}),b=b||{},c=c||function(){},e=e||a.errors.handleError,a.picker.createPicker(b,c,e,!0)},g=function(b,c,e,f){if(d(),!b||!c||"function"==typeof b||"function"==typeof b)throw new a.FilepickerException("Not all required parameters given, missing picker or store options");f=f||a.errors.handleError;var g=!!b.multiple,h=b?a.util.clone(b):{};if(h.storeLocation=c.location||"S3",h.storePath=c.path,h.storeAccess=c.access||"private",g&&h.storePath&&"/"!=h.storePath.charAt(h.storePath.length-1))throw new a.FilepickerException("pickAndStore with multiple files requires a path that ends in '/'");var i=e;g||(i=function(a){e([a])}),a.picker.createPicker(h,i,f,g)},h=function(b,c,e,f,g){if(d(),!b)throw new a.FilepickerException("No input given - nothing to read!");if("function"==typeof c&&(g=f,f=e,e=c,c={}),c=c||{},e=e||function(){},f=f||a.errors.handleError,g=g||function(){},"string"==typeof b)a.util.isFPUrl(b)?a.files.readFromFPUrl(b,c,e,f,g):a.files.readFromUrl(b,c,e,f,g);else if(a.util.isFileInputElement(b))b.files?0===b.files.length?f(new a.errors.FPError(115)):a.files.readFromFile(b.files[0],c,e,f,g):i(b,c,e,f,g);else if(a.util.isFile(b))a.files.readFromFile(b,c,e,f,g);else{if(!b.url)throw new a.FilepickerException("Cannot read given input: "+b+". Not a url, file input, DOM File, or FPFile object.");a.files.readFromFPUrl(b.url,c,e,f,g)}},i=function(b,c,d,e,f){f(10),a.store(b,function(b){f(50),a.read(b,c,d,e,function(a){f(50+a/2)})},e)},j=function(b,c,e,f,g,h){if(d(),!b)throw new a.FilepickerException("No fpfile given - nothing to write to!");if(void 0===c||null===c)throw new a.FilepickerException("No input given - nothing to write!");"function"==typeof e&&(h=g,g=f,f=e,e={}),e=e||{},f=f||function(){},g=g||a.errors.handleError,h=h||function(){};var i;if(a.util.isFPUrl(b))i=b;else{if(!b.url)throw new a.FilepickerException("Invalid file to write to: "+b+". Not a filepicker url or FPFile object.");i=b.url}if("string"==typeof c)a.files.writeDataToFPUrl(i,c,e,f,g,h);else if(a.util.isFileInputElement(c))c.files?0===c.files.length?g(new a.errors.FPError(115)):a.files.writeFileToFPUrl(i,c.files[0],e,f,g,h):a.files.writeFileInputToFPUrl(i,c,e,f,g,h);else if(a.util.isFile(c))a.files.writeFileToFPUrl(i,c,e,f,g,h);else{if(!c.url)throw new a.FilepickerException("Cannot read from given input: "+c+". Not a string, file input, DOM File, or FPFile object.");a.files.writeUrlToFPUrl(i,c.url,e,f,g,h)}},k=function(b,c,e,f,g,h){if(d(),!b)throw new a.FilepickerException("No fpfile given - nothing to write to!");if(void 0===c||null===c)throw new a.FilepickerException("No input given - nothing to write!");"function"==typeof e&&(h=g,g=f,f=e,e={}),e=e||{},f=f||function(){},g=g||a.errors.handleError,h=h||function(){};var i;if(a.util.isFPUrl(b))i=b;else{if(!b.url)throw new a.FilepickerException("Invalid file to write to: "+b+". Not a filepicker url or FPFile object.");i=b.url}a.files.writeUrlToFPUrl(i,c,e,f,g,h)},l=function(b,c,e,f){d(),"function"==typeof c&&(f=e,e=c,c={}),c=c?a.util.clone(c):{},e=e||function(){},f=f||a.errors.handleError;var g;if("string"==typeof b&&a.util.isUrl(b))g=b;else{if(!b.url)throw new a.FilepickerException("Invalid file to export: "+b+". Not a valid url or FPFile object. You may want to use filepicker.store() to get an FPFile to export");g=b.url,c.mimetype||c.extension||(c.mimetype=b.mimetype),c.suggestedFilename||(c.suggestedFilename=b.filename)}a.exporter.createExporter(g,c,e,f)},m=function(b,c,e,f,g){if(d(),"function"==typeof c&&(g=f,f=e,e=c,c={}),c=c?a.util.clone(c):{},e=e||function(){},f=f||a.errors.handleError,g=g||function(){},"string"==typeof b)a.files.storeData(b,c,e,f,g);else if(a.util.isFileInputElement(b))b.files?0===b.files.length?f(new a.errors.FPError(115)):a.files.storeFile(b.files[0],c,e,f,g):a.files.storeFileInput(b,c,e,f,g);else if(a.util.isFile(b))a.files.storeFile(b,c,e,f,g);else{if(!b.url)throw new a.FilepickerException("Cannot store given input: "+b+". Not a string, file input, DOM File, or FPFile object.");c.filename||(c.filename=b.filename),a.files.storeUrl(b.url,c,e,f,g)}},n=function(b,c,e,f,g){d(),"function"==typeof c&&(g=f,f=e,e=c,c={}),c=c||{},e=e||function(){},f=f||a.errors.handleError,g=g||function(){},a.files.storeUrl(b,c,e,f,g)},o=function(b,c,e,f){d(),"function"==typeof c&&(f=e,e=c,c={}),c=c||{},e=e||function(){},f=f||a.errors.handleError;var g;if(a.util.isFPUrl(b))g=b;else{if(!b.url)throw new a.FilepickerException("Invalid file to get metadata for: "+b+". Not a filepicker url or FPFile object.");g=b.url}a.files.stat(g,c,e,f)},p=function(b,c,e,f){d(),"function"==typeof c&&(f=e,e=c,c={}),c=c||{},e=e||function(){},f=f||a.errors.handleError;var g;if(a.util.isFPUrl(b))g=b;else{if(!b.url)throw new a.FilepickerException("Invalid file to remove: "+b+". Not a filepicker url or FPFile object.");g=b.url}a.files.remove(g,c,e,f)},q=function(b,c,e,f,g,h){if(d(),!b)throw new a.FilepickerException("No fpfile given - nothing to convert!");"function"==typeof e&&(h=g,g=f,f=e,e={}),options=c?a.util.clone(c):{},e=e||{},f=f||function(){},g=g||a.errors.handleError,h=h||function(){},e.location&&(options.storeLocation=e.location),e.path&&(options.storePath=e.path),options.storeAccess=e.access||"private";var i;if(a.util.isFPUrl(b))i=b;else{if(!b.url)throw new a.FilepickerException("Invalid file to convert: "+b+". Not a filepicker url or FPFile object.");if(i=b.url,!a.mimetypes.matchesMimetype(b.mimetype,"image/*"))return void g(new a.errors.FPError(142))}a.conversions.convert(i,options,f,g,h)},r=function(b){return a.widgets.constructWidget(b)},s=function(b,c){return a.dragdrop.makeDropPane(b,c)};return{setKey:b,pick:e,pickMultiple:f,pickAndStore:g,read:h,write:j,writeUrl:k,"export":l,exportFile:l,store:m,storeUrl:n,stat:o,metadata:o,remove:p,convert:q,constructWidget:r,makeDropPane:s,FilepickerException:c}},!0),filepicker.extend("mimetypes",function(){var a=this,b={".stl":"applicaiton/sla",".hbs":"text/html",".pdf":"application/pdf",".jpg":"image/jpeg",".jpeg":"image/jpeg",".jpe":"image/jpeg",".imp":"application/x-impressionist"},c=["application/octet-stream","application/download","application/force-download","octet/stream","application/unknown","application/x-download","application/x-msdownload","application/x-secure-download"],d=function(a){if(a.type){var d=a.type;d=d.toLowerCase();for(var e=!1,f=0;f<c.length;f++)e=e||d==c[f];if(!e)return a.type}var g=a.name||a.fileName,h=g.match(/\.\w*$/);return h?b[h[0].toLowerCase()]||"":a.type?a.type:""},e=function(b,d){if(!b)return"*/*"==d;b=a.util.trim(b).toLowerCase(),d=a.util.trim(d).toLowerCase();for(var e=0;e<c.length;e++)if(b==c[e])return!0;return test_parts=b.split("/"),against_parts=d.split("/"),"*"==against_parts[0]?!0:against_parts[0]!=test_parts[0]?!1:"*"==against_parts[1]?!0:against_parts[1]==test_parts[1]};return{getMimetype:d,matchesMimetype:e}}),filepicker.extend("modal",function(){var a=this,b="filepicker_shade",c="filepicker_dialog_container",d=function(b,c){var d=e(c),h=f(),i=g(c),j=document.createElement("iframe");j.name=a.window.WINDOW_NAME,j.id=a.window.WINDOW_NAME;var k=a.window.getSize(),l=Math.min(k[1]-40,500);return j.style.width="100%",j.style.height=l-32+"px",j.style.border="none",j.style.position="relative",j.setAttribute("border",0),j.setAttribute("frameborder",0),j.setAttribute("frameBorder",0),j.setAttribute("marginwidth",0),j.setAttribute("marginheight",0),j.src=b,document.body.appendChild(d),h.appendChild(i),h.appendChild(j),document.body.appendChild(h),j},e=function(a){var c=document.createElement("div");return c.id=b,c.style.position="fixed",c.style.top=0,c.style.bottom=0,c.style.right=0,c.style.left=0,c.style.backgroundColor="#000000",c.style.opacity="0.5",c.style.filter="alpha(opacity=50)",c.style.zIndex=1e4,c.onclick=h(a),c
},f=function(){var b=document.createElement("div");b.id=c,b.style.position="fixed",b.style.padding="10px",b.style.background='#ffffff url("https://www.filepicker.io/static/img/spinner.gif") no-repeat 50% 50%',b.style.top="10px",b.style.bottom="auto",b.style.right="auto";var d=a.window.getSize(),e=Math.min(d[1]-40,500),f=Math.max(Math.min(d[0]-40,800),620),g=(d[0]-f-40)/2;return b.style.left=g+"px",b.style.height=e+"px",b.style.width=f+"px",b.style.overflow="hidden",b.style.webkitOverflowScrolling="touch",b.style.border="1px solid #999",b.style.webkitBorderRadius="3px",b.style.borderRadius="3px",b.style.margin="0",b.style.webkitBoxShadow="0 3px 7px rgba(0, 0, 0, 0.3)",b.style.boxShadow="0 3px 7px rgba(0, 0, 0, 0.3)",b.style.zIndex=10001,b.style.boxSizing="content-box",b.style.webkitBoxSizing="content-box",b.style.mozBoxSizing="content-box",b},g=function(a){var b=document.createElement("a");return b.appendChild(document.createTextNode("×")),b.onclick=h(a),b.style.cssFloat="right",b.style.styleFloat="right",b.style.cursor="default",b.style.padding="0 5px 0 0px",b.style.fontSize="1.5em",b.style.color="#555555",b.style.textDecoration="none",b},h=function(d,e){return e=!!e,function(){if(!a.uploading||e||window.confirm("You are currently uploading. If you choose 'OK', the window will close and your upload will not finish. Do you want to stop uploading and close the window?")){a.uploading=!1;var f=document.getElementById(b);f&&document.body.removeChild(f);var g=document.getElementById(c);g&&document.body.removeChild(g);try{delete window.frames[a.window.WINDOW_NAME]}catch(h){}d&&d()}}},i=h(function(){});return{generate:d,close:i}}),filepicker.extend("picker",function(){var a=this,b=function(b){var c=function(c,d,e){b[d]?a.util.isArray(b[d])||(b[d]=[b[d]]):b[c]?b[d]=[b[c]]:e&&(b[d]=e)};if(c("service","services"),c("mimetype","mimetypes"),c("extension","extensions"),b.services)for(var d=0;d<b.services.length;d++){var e=(""+b.services[d]).replace(" ","");void 0!==a.services[e]&&(e=a.services[e]),b.services[d]=e}if(b.mimetypes&&b.extensions)throw a.FilepickerException("Error: Cannot pass in both mimetype and extension parameters to the pick function");b.mimetypes||b.extensions||(b.mimetypes=["*/*"]),b.openTo&&(b.openTo=a.services[b.openTo]||b.openTo),a.util.setDefault(b,"container","modal")},c=function(b,c){var d=function(d){if("filepickerUrl"===d.type){if(a.uploading=!1,d.error)a.util.console.error(d.error),c(a.errors.FPError(102));else{var e={};e.url=d.payload.url,e.filename=d.payload.data.filename,e.mimetype=d.payload.data.type,e.size=d.payload.data.size,d.payload.data.key&&(e.key=d.payload.data.key),e.isWriteable=!0,b(e)}a.modal.close()}};return d},d=function(b){b=b||function(){};var c=function(c){"uploading"===c.type&&(a.uploading=!!c.payload,b(a.uploading))};return c},e=function(b,c){var d=function(d){if("filepickerUrl"===d.type){if(a.uploading=!1,d.error)a.util.console.error(d.error),c(a.errors.FPError(102));else{var e=[];a.util.isArray(d.payload)||(d.payload=[d.payload]);for(var f=0;f<d.payload.length;f++){var g={},h=d.payload[f];g.url=h.url,g.filename=h.data.filename,g.mimetype=h.data.type,g.size=h.data.size,h.data.key&&(g.key=h.data.key),g.isWriteable=!0,e.push(g)}b(e)}a.modal.close()}};return d},f=function(g,h,i,j){if(b(g),g.debug)return void setTimeout(function(){h({url:"https://www.filepicker.io/api/file/-nBq2onTSemLBxlcBWn1",filename:"test.png",mimetype:"image/png",size:58979})},1);if(void 0===a.cookies.THIRD_PARTY_COOKIES)return void a.cookies.checkThirdParty(function(){f(g,h,i,!!j)});var k=a.util.getId(),l=!1,m=function(a){l=!0,h(a)},n=function(a){l=!0,i(a)},o=function(){l||(l=!0,i(a.errors.FPError(101)))};"modal"==g.container&&(g.mobile||a.window.shouldForce())&&(g.container="window"),a.window.open(g.container,a.urls.constructPickUrl(g,k,j),o);var p=j?e(m,n):c(m,n);a.handlers.attach(k,p);var q=k+"-upload";a.handlers.attach(q,d(function(){a.handlers.detach(q)}))};return{createPicker:f}}),filepicker.extend("services",function(){return{COMPUTER:1,DROPBOX:2,FACEBOOK:3,GITHUB:4,GMAIL:5,IMAGE_SEARCH:6,URL:7,WEBCAM:8,GOOGLE_DRIVE:9,SEND_EMAIL:10,INSTAGRAM:11,FLICKR:12,VIDEO:13,EVERNOTE:14,PICASA:15,WEBDAV:16,FTP:17,ALFRESCO:18,BOX:19,SKYDRIVE:20}},!0),filepicker.extend("util",function(){var a=function(a){return a.replace(/^\s+|\s+$/g,"")},b=/^(http|https)\:.*\/\//i,c=function(a){return!!a.match(b)},d=function(a){a&&"/"!=a.charAt(0)||(a=window.location.protocol+"//"+window.location.host+a);var b=document.createElement("a");b.href=a;var c=-1==b.hostname.indexOf(":")?b.hostname:b.host,d={source:a,protocol:b.protocol.replace(":",""),host:c,port:b.port,query:b.search,params:function(){for(var a,c={},d=b.search.replace(/^\?/,"").split("&"),e=d.length,f=0;e>f;f++)d[f]&&(a=d[f].split("="),c[a[0]]=a[1]);return c}(),file:(b.pathname.match(/\/([^\/?#]+)$/i)||[,""])[1],hash:b.hash.replace("#",""),path:b.pathname.replace(/^([^\/])/,"/$1"),relative:(b.href.match(/tps?:\/\/[^\/]+(.+)/)||[,""])[1],segments:b.pathname.replace(/^\//,"").split("/")};return d.origin=d.protocol+"://"+d.host+(d.port?":"+d.port:""),d},e=function(a,b){return-1!==a.indexOf(b,a.length-b.length)};return{trim:a,parseUrl:d,isUrl:c,endsWith:e}}),filepicker.extend("urls",function(){var a=this,b="https://www.filepicker.io";window.filepicker.hostname&&(b=window.filepicker.hostname);var c=b+"/dialog/open/",d=b+"/dialog/save/",e=b+"/api/store/",f=function(b,d,e){return c+"?key="+a.apikey+"&id="+d+"&referrer="+window.location.hostname+"&iframe="+("window"!=b.container)+"&version="+a.API_VERSION+(b.services?"&s="+b.services.join(","):"")+(e?"&multi="+!!e:"")+(void 0!==b.mimetypes?"&m="+b.mimetypes.join(","):"")+(void 0!==b.extensions?"&ext="+b.extensions.join(","):"")+(void 0!==b.openTo?"&loc="+b.openTo:"")+(b.maxSize?"&maxSize="+b.maxSize:"")+(b.signature?"&signature="+b.signature:"")+(b.policy?"&policy="+b.policy:"")+(void 0!==b.mobile?"&mobile="+b.mobile:"")+(b.storeLocation?"&storeLocation="+b.storeLocation:"")+(b.storePath?"&storePath="+b.storePath:"")+(b.storeAccess?"&storeAccess="+b.storeAccess:"")},g=function(b,c,e){return(b.indexOf("&")>=0||b.indexOf("?")>=0)&&(b=encodeURIComponent(b)),d+"?url="+b+"&key="+a.apikey+"&id="+e+"&referrer="+window.location.hostname+"&iframe="+("window"!=c.container)+"&version="+a.API_VERSION+(c.services?"&s="+c.services.join(","):"")+(void 0!==c.openTo?"&loc="+c.openTo:"")+(void 0!==c.mimetype?"&m="+c.mimetype:"")+(void 0!==c.extension?"&ext="+c.extension:"")+(void 0!==c.mobile?"&mobile="+c.mobile:"")+(void 0!==c.suggestedFilename?"&defaultSaveasName="+c.suggestedFilename:"")+(c.signature?"&signature="+c.signature:"")+(c.policy?"&policy="+c.policy:"")},h=function(b){return e+b.storage+"?key="+a.apikey+(b.base64decode?"&base64decode=true":"")+(b.mimetype?"&mimetype="+b.mimetype:"")+(b.filename?"&filename="+b.filename:"")+(b.path?"&path="+b.path:"")+(b.access?"&access="+b.access:"")+(b.signature?"&signature="+b.signature:"")+(b.policy?"&policy="+b.policy:"")},i=function(a,b){return a+"?nonce=fp"+(b.base64decode?"&base64decode=true":"")+(b.mimetype?"&mimetype="+b.mimetype:"")+(b.signature?"&signature="+b.signature:"")+(b.policy?"&policy="+b.policy:"")},j=function(){var b=a.util.parseUrl(window.location.href);return b.origin+"/404"};return{BASE:b,COMM:b+"/dialog/comm_iframe/",FP_COMM_FALLBACK:b+"/dialog/comm_hash_iframe/",STORE:e,PICK:c,EXPORT:d,constructPickUrl:f,constructExportUrl:g,constructWriteUrl:i,constructStoreUrl:h,constructHostCommFallback:j}}),filepicker.extend("util",function(){var a=function(a){return a&&"[object Array]"===Object.prototype.toString.call(a)},b=function(a){return a&&"[object File]"===Object.prototype.toString.call(a)},c=function(a){return"object"==typeof HTMLElement?a instanceof HTMLElement:a&&"object"==typeof a&&1===a.nodeType&&"string"==typeof a.nodeName},d=function(a){return c(a)&&"INPUT"==a.tagName&&"file"==a.type},e=function(c){return null===c?"null":a(c)?"array":b(c)?"file":typeof c},f=function(){var a=new Date;return a.getTime().toString()},g=function(a,b,c){void 0===a[b]&&(a[b]=c)},h=function(a){if(window.jQuery)window.jQuery(function(){a()});else{var b="load";if(window.addEventListener)window.addEventListener(b,a,!1);else if(window.attachEvent)window.attachEvent("on"+b,a);else if(window.onload){var c=window.onload;window.onload=function(){c(),a()}}else window.onload=a}},i=function(a){return"string"==typeof a&&a.match("www.filepicker.io/api/file/")},j=function(a){return function(){if(window.console&&"function"==typeof window.console[a])try{window.console[a].apply(window.console,arguments)}catch(b){alert(Array.prototype.join.call(arguments,","))}}},k={};k.log=j("log"),k.error=j("error");var l=function(a){var b={};for(key in a)b[key]=a[key];return b},m=function(a){var b={};return b.url=a.url,b.filename=a.filename||a.name,b.mimetype=a.mimetype||a.type,b.size=a.size,b.key=a.key||a.s3_key,b.isWriteable=!(!a.isWriteable&&!a.writeable),b};return{isArray:a,isFile:b,isElement:c,isFileInputElement:d,getId:f,setDefault:g,typeOf:e,addOnLoad:h,isFPUrl:i,console:k,clone:l,standardizeFPFile:m}}),filepicker.extend("widgets",function(){var a=this,b=function(a,b,c,d){var e=d.getAttribute(c);e&&(b[a]=e)},c=function(a,b){var c;document.createEvent?(c=document.createEvent("Event"),c.initEvent("change",!0,!1),c.fpfile=b?b[0]:void 0,c.fpfiles=b,a.dispatchEvent(c)):document.createEventObject?(c=document.createEventObject("Event"),c.eventPhase=2,c.currentTarget=c.srcElement=c.target=a,c.fpfile=b?b[0]:void 0,c.fpfiles=b,a.fireEvent("onchange",c)):a.onchange&&a.onchange(b)},d=function(d){var e=document.createElement("button");e.setAttribute("type","button"),e.innerHTML=d.getAttribute("data-fp-button-text")||d.getAttribute("data-fp-text")||"Pick File",e.className=d.getAttribute("data-fp-button-class")||d.getAttribute("data-fp-class")||d.className,d.style.display="none";var f={};b("container",f,"data-fp-option-container",d),b("maxSize",f,"data-fp-option-maxsize",d),b("mimetype",f,"data-fp-mimetype",d),b("mimetypes",f,"data-fp-mimetypes",d),b("extension",f,"data-fp-extension",d),b("extensions",f,"data-fp-extensions",d),b("container",f,"data-fp-container",d),b("maxSize",f,"data-fp-maxSize",d),b("openTo",f,"data-fp-openTo",d),b("debug",f,"data-fp-debug",d),b("signature",f,"data-fp-signature",d),b("policy",f,"data-fp-policy",d),b("storeLocation",f,"data-fp-store-location",d),b("storePath",f,"data-fp-store-path",d),b("storeAccess",f,"data-fp-store-access",d);var g=d.getAttribute("data-fp-services");if(g||(g=d.getAttribute("data-fp-option-services")),g){g=g.split(",");for(var h=0;h<g.length;h++)g[h]=a.services[g[h].replace(" ","")];f.services=g}var i=d.getAttribute("data-fp-service");i&&(f.service=a.services[i.replace(" ","")]),f.mimetypes&&(f.mimetypes=f.mimetypes.split(",")),f.extensions&&(f.extensions=f.extensions.split(","));var j=d.getAttribute("data-fp-apikey");j&&a.setKey(j);var k="true"==(d.getAttribute("data-fp-multiple")||d.getAttribute("data-fp-option-multiple")||"false");e.onclick=k?function(){return e.blur(),a.pickMultiple(f,function(a){for(var b=[],e=0;e<a.length;e++)b.push(a[e].url);d.value=b.join(),c(d,a)}),!1}:function(){return e.blur(),a.pick(f,function(a){d.value=a.url,c(d,[a])}),!1},d.parentNode.insertBefore(e,d)},e=function(d){var e=document.createElement("div");e.className=d.getAttribute("data-fp-class")||d.className,e.style.padding="1px",d.style.display="none",d.parentNode.insertBefore(e,d);var i=document.createElement("button");i.setAttribute("type","button"),i.innerHTML=d.getAttribute("data-fp-button-text")||"Pick File",i.className=d.getAttribute("data-fp-button-class")||"",e.appendChild(i);var j=document.createElement("div");g(j),j.innerHTML=d.getAttribute("data-fp-drag-text")||"Or drop files here",j.className=d.getAttribute("data-fp-drag-class")||"",e.appendChild(j);var k={};b("container",k,"data-fp-option-container",d),b("maxSize",k,"data-fp-option-maxsize",d),b("mimetype",k,"data-fp-mimetype",d),b("mimetypes",k,"data-fp-mimetypes",d),b("extension",k,"data-fp-extension",d),b("extensions",k,"data-fp-extensions",d),b("container",k,"data-fp-container",d),b("maxSize",k,"data-fp-maxSize",d),b("openTo",k,"data-fp-openTo",d),b("debug",k,"data-fp-debug",d),b("signature",k,"data-fp-signature",d),b("policy",k,"data-fp-policy",d),b("storeLocation",k,"data-fp-store-location",d),b("storePath",k,"data-fp-store-path",d),b("storeAccess",k,"data-fp-store-access",d);var l=d.getAttribute("data-fp-services");if(l||(l=d.getAttribute("data-fp-option-services")),l){l=l.split(",");for(var m=0;m<l.length;m++)l[m]=a.services[l[m].replace(" ","")];k.services=l}var n=d.getAttribute("data-fp-service");n&&(k.service=a.services[n.replace(" ","")]),k.mimetypes&&(k.mimetypes=k.mimetypes.split(",")),k.extensions&&(k.extensions=k.extensions.split(","));var o=d.getAttribute("data-fp-apikey");o&&a.setKey(o);var p="true"==(d.getAttribute("data-fp-multiple")||d.getAttribute("data-fp-option-multiple")||"false");a.dragdrop.enabled()?h(j,p,k,d):j.innerHTML="&nbsp;",j.onclick=i.onclick=p?function(){return i.blur(),a.pickMultiple(k,function(a){for(var b=[],e=[],g=0;g<a.length;g++)b.push(a[g].url),e.push(a[g].filename);d.value=b.join(),f(d,j,e.join(", ")),c(d,a)}),!1}:function(){return i.blur(),a.pick(k,function(a){d.value=a.url,f(d,j,a.filename),c(d,[a])}),!1}},f=function(b,d,e){d.innerHTML=e,d.style.padding="2px 4px",d.style.cursor="default",d.style.width="";var f=document.createElement("span");f.innerHTML="X",f.style.borderRadius="8px",f.style.fontSize="14px",f.style.cssFloat="right",f.style.padding="0 3px",f.style.color="#600",f.style.cursor="pointer";var h=function(e){return e||(e=window.event),e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),g(d),d.innerHTML=a.dragdrop.enabled?b.getAttribute("data-fp-drag-text")||"Or drop files here":"&nbsp;",b.value="",c(b),!1};f.addEventListener?f.addEventListener("click",h,!1):f.attachEvent&&f.attachEvent("onclick",h),d.appendChild(f)},g=function(a){a.style.border="1px dashed #AAA",a.style.display="inline-block",a.style.margin="0 0 0 4px",a.style.borderRadius="3px",a.style.backgroundColor="#F3F3F3",a.style.color="#333",a.style.fontSize="14px",a.style.lineHeight="22px",a.style.padding="2px 4px",a.style.verticalAlign="middle",a.style.cursor="pointer",a.style.overflow="hidden"},h=function(b,d,e,g){var h,j=b.innerHTML;a.dragdrop.makeDropPane(b,{multiple:d,maxSize:e.maxSize,mimetypes:e.mimetypes,mimetype:e.mimetype,extensions:e.extensions,extension:e.extension,location:e.storeLocation,path:e.storePath,access:e.storeAccess,policy:e.policy,signature:e.signature,dragEnter:function(){b.innerHTML="Drop to upload",b.style.backgroundColor="#E0E0E0",b.style.border="1px solid #000"},dragLeave:function(){b.innerHTML=j,b.style.backgroundColor="#F3F3F3",b.style.border="1px dashed #AAA"},onError:function(a,c){"TooManyFiles"==a?b.innerHTML=c:"WrongType"==a?b.innerHTML=c:"NoFilesFound"==a?b.innerHTML=c:"UploadError"==a&&(b.innerHTML="Oops! Had trouble uploading.")},onStart:function(){h=i(b)},onProgress:function(a){h&&(h.style.width=a+"%")},onSuccess:function(a){for(var d=[],e=[],h=0;h<a.length;h++)d.push(a[h].url),e.push(a[h].filename);g.value=d.join(),f(g,b,e.join(", ")),c(g,a)}})},i=function(a){var b=document.createElement("div"),c=a.offsetHeight-2;return b.style.height=c+"px",b.style.backgroundColor="#0E90D2",b.style.width="2%",b.style.borderRadius="3px",a.style.width=a.offsetWidth+"px",a.style.padding="0",a.style.border="1px solid #AAA",a.style.backgroundColor="#F3F3F3",a.style.boxShadow="inset 0 1px 2px rgba(0, 0, 0, 0.1)",a.innerHTML="",a.appendChild(b),b},j=function(c){c.onclick=function(){var d=c.getAttribute("data-fp-url");if(!d)return!0;var e={};b("container",e,"data-fp-option-container",c),b("suggestedFilename",e,"data-fp-option-defaultSaveasName",c),b("container",e,"data-fp-container",c),b("suggestedFilename",e,"data-fp-suggestedFilename",c),b("mimetype",e,"data-fp-mimetype",c),b("extension",e,"data-fp-extension",c);var f=c.getAttribute("data-fp-services");if(f||(f=c.getAttribute("data-fp-option-services")),f){f=f.split(",");for(var g=0;g<f.length;g++)f[g]=a.services[f[g].replace(" ","")];e.services=f}var h=c.getAttribute("data-fp-service");return h&&(e.service=a.services[h.replace(" ","")]),apikey=c.getAttribute("data-fp-apikey"),apikey&&a.setKey(apikey),a.exportFile(d,e),!1}},k=function(){if(document.querySelectorAll){var a,b=document.querySelectorAll('input[type="filepicker"]');for(a=0;a<b.length;a++)d(b[a]);var c=document.querySelectorAll('input[type="filepicker-dragdrop"]');for(a=0;a<c.length;a++)e(c[a]);var f=[],g=document.querySelectorAll("button[data-fp-url]");for(a=0;a<g.length;a++)f.push(g[a]);for(g=document.querySelectorAll("a[data-fp-url]"),a=0;a<g.length;a++)f.push(g[a]);for(g=document.querySelectorAll('input[type="button"][data-fp-url]'),a=0;a<g.length;a++)f.push(g[a]);for(a=0;a<f.length;a++)j(f[a])}},l=function(a){a.jquery&&(a=a[0]);var b=a.getAttribute("type");"filepicker"==b?d(a):"filepicker-dragdrop"==b?e(a):j(a)};return{constructPickWidget:d,constructDragWidget:e,constructExportWidget:j,buildWidgets:k,constructWidget:l}}),filepicker.extend("window",function(){var a=this,b="filepicker_dialog",c="left=100,top=100,height=600,width=800,menubar=no,toolbar=no,location=no,personalbar=no,status=no,resizable=yes,scrollbars=yes,dependent=yes,dialog=yes",d=1e3,e=function(){return document.body&&document.body.offsetWidth&&(winW=document.body.offsetWidth,winH=document.body.offsetHeight),"CSS1Compat"==document.compatMode&&document.documentElement&&document.documentElement.offsetWidth&&(winW=document.documentElement.offsetWidth,winH=document.documentElement.offsetHeight),window.innerWidth&&window.innerHeight&&(winW=window.innerWidth,winH=window.innerHeight),[winW,winH]},f=function(){var b=e()[0]<768,c=a.cookies.THIRD_PARTY_COOKIES===!1;return a.browser.isIOS()||a.browser.isAndroid()||b||c},g=function(e,g,h){if(h=h||function(){},e||(e="modal"),"modal"==e&&f()&&(e="window"),"window"==e)var i=b+a.util.getId(),j=window.open(g,i,c),k=window.setInterval(function(){(!j||j.closed)&&(window.clearInterval(k),h())},d);else if("modal"==e)a.modal.generate(g,h);else{var l=document.getElementById(e);if(!l)throw new a.FilepickerException("Container '"+e+"' not found. This should either be set to 'window','modal', or the ID of an iframe that is currently in the document.");l.src=g}};return{open:g,WINDOW_NAME:b,getSize:e,shouldForce:f}}),function(){filepicker.internal(function(){var a=this;a.util.addOnLoad(a.cookies.checkThirdParty),a.util.addOnLoad(a.widgets.buildWidgets)}),delete filepicker.internal,delete filepicker.extend;var a,b=filepicker._queue||[],c=b.length;if(c)for(var d=0;c>d;d++)a=b[d],filepicker[a[0]].apply(filepicker,a[1]);delete filepicker._queue}();